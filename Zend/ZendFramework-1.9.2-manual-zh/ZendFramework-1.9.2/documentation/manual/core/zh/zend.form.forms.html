<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>23.4.  使用 Zend_Form 生成表单</title>
<link rel="stylesheet" href="dbstyle.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.72.0">
<link rel="start" href="index.html" title="Zend Framework手册 中文版">
<link rel="up" href="zend.form.html" title="第 23 章 Zend_Form">
<link rel="prev" href="zend.form.elements.html" title="23.3.  使用 Zend_Form_Element 生成表单元素">
<link rel="next" href="zend.form.decorators.html" title="23.5.  使用 Zend_Form_Decorator 生成定制的表单标识（Markup）">
<link rel="chapter" href="introduction.html" title="第 1 章 Zend Framework简介">
<link rel="chapter" href="zend.acl.html" title="第 2 章 Zend_Acl">
<link rel="chapter" href="zend.amf.html" title="第 3 章 Zend_Amf">
<link rel="chapter" href="zend.application.html" title="第 4 章 Zend_Application">
<link rel="chapter" href="zend.auth.html" title="第 5 章 Zend_Auth">
<link rel="chapter" href="zend.cache.html" title="第 6 章 Zend_Cache">
<link rel="chapter" href="zend.captcha.html" title="第 7 章 Zend_Captcha">
<link rel="chapter" href="zend.codegenerator.html" title="第 8 章 Zend_CodeGenerator">
<link rel="chapter" href="zend.config.html" title="第 9 章 Zend_Config">
<link rel="chapter" href="zend.config.writer.html" title="第 10 章 Zend_Config_Writer">
<link rel="chapter" href="zend.console.getopt.html" title="第 11 章 Zend_Console_Getopt">
<link rel="chapter" href="zend.controller.html" title="第 12 章 Zend_Controller">
<link rel="chapter" href="zend.currency.html" title="第 13 章 Zend_Currency">
<link rel="chapter" href="zend.date.html" title="第 14 章 Zend_Date">
<link rel="chapter" href="zend.db.html" title="第 15 章 Zend_Db">
<link rel="chapter" href="zend.debug.html" title="第 16 章 Zend_Debug">
<link rel="chapter" href="zend.dojo.html" title="第 17 章 Zend_Dojo">
<link rel="chapter" href="zend.dom.html" title="第 18 章 Zend_Dom">
<link rel="chapter" href="zend.exception.html" title="第 19 章 Zend_Exception">
<link rel="chapter" href="zend.feed.html" title="第 20 章 Zend_Feed">
<link rel="chapter" href="zend.file.html" title="第 21 章 Zend_File">
<link rel="chapter" href="zend.filter.html" title="第 22 章 Zend_Filter">
<link rel="chapter" href="zend.form.html" title="第 23 章 Zend_Form">
<link rel="chapter" href="zend.gdata.html" title="第 24 章 Zend_Gdata">
<link rel="chapter" href="zend.http.html" title="第 25 章 Zend_Http">
<link rel="chapter" href="zend.infocard.html" title="第 26 章 Zend_InfoCard">
<link rel="chapter" href="zend.json.html" title="第 27 章 Zend_Json">
<link rel="chapter" href="zend.layout.html" title="第 28 章 Zend_Layout">
<link rel="chapter" href="zend.ldap.html" title="第 29 章 Zend_Ldap">
<link rel="chapter" href="zend.loader.html" title="第 30 章 Zend_Loader">
<link rel="chapter" href="zend.locale.html" title="第 31 章 Zend_Locale">
<link rel="chapter" href="zend.log.html" title="第 32 章 Zend_Log">
<link rel="chapter" href="zend.mail.html" title="第 33 章 Zend_Mail">
<link rel="chapter" href="zend.measure.html" title="第 34 章 Zend_Measure">
<link rel="chapter" href="zend.memory.html" title="第 35 章 Zend_Memory">
<link rel="chapter" href="zend.mime.html" title="第 36 章 Zend_Mime">
<link rel="chapter" href="zend.navigation.html" title="第 37 章 Zend_Navigation">
<link rel="chapter" href="zend.openid.html" title="第 38 章 Zend_OpenId">
<link rel="chapter" href="zend.paginator.html" title="第 39 章 Zend_Paginator">
<link rel="chapter" href="zend.pdf.html" title="第 40 章 Zend_Pdf">
<link rel="chapter" href="zend.progressbar.html" title="第 41 章 Zend_ProgressBar">
<link rel="chapter" href="zend.queue.html" title="第 42 章 Zend_Queue">
<link rel="chapter" href="zend.reflection.html" title="第 43 章 Zend_Reflection">
<link rel="chapter" href="zend.registry.html" title="第 44 章 Zend_Registry">
<link rel="chapter" href="zend.rest.html" title="第 45 章 Zend_Rest">
<link rel="chapter" href="zend.search.lucene.html" title="第 46 章 Zend_Search_Lucene">
<link rel="chapter" href="zend.server.html" title="第 47 章 Zend_Server">
<link rel="chapter" href="zend.service.html" title="第 48 章 Zend_Service">
<link rel="chapter" href="zend.session.html" title="第 49 章 Zend_Session">
<link rel="chapter" href="zend.soap.html" title="第 50 章 Zend_Soap">
<link rel="chapter" href="zend.tag.html" title="第 51 章 Zend_Tag">
<link rel="chapter" href="zend.test.html" title="第 52 章 Zend_Test">
<link rel="chapter" href="zend.text.html" title="第 53 章 Zend_Text">
<link rel="chapter" href="zend.timesync.html" title="第 54 章 Zend_TimeSync">
<link rel="chapter" href="zend.tool.framework.html" title="第 55 章 Zend_Tool_Framework">
<link rel="chapter" href="zend.tool.project.html" title="第 56 章 Zend_Tool_Project">
<link rel="chapter" href="zend.translate.html" title="第 57 章 Zend_Translate">
<link rel="chapter" href="zend.uri.html" title="第 58 章 Zend_Uri">
<link rel="chapter" href="zend.validate.html" title="第 59 章 Zend_Validate">
<link rel="chapter" href="zend.version.html" title="第 60 章 Zend_Version">
<link rel="chapter" href="zend.view.html" title="第 61 章 Zend_View">
<link rel="chapter" href="zend.wildfire.html" title="第 62 章 Zend_Wildfire">
<link rel="chapter" href="zend.xmlrpc.html" title="第 63 章 Zend_XmlRpc">
<link rel="chapter" href="zendx.console.process.unix.html" title="第 64 章 ZendX_Console_Process_Unix">
<link rel="chapter" href="zendx.jquery.html" title="第 65 章 ZendX_JQuery">
<link rel="appendix" href="requirements.html" title="附录 A. 系统需求">
<link rel="appendix" href="coding-standard.html" title="附录 B. Zend Framework 的 PHP 编码标准">
<link rel="appendix" href="doc-standard.html" title="附录 C. Zend Framework Documentation Standard">
<link rel="appendix" href="project-structure.html" title="附录 D. Recommended Project Structure for Zend Framework MVC Applications">
<link rel="appendix" href="performance.html" title="附录 E. Zend Framework Performance Guide">
<link rel="appendix" href="copyrights.html" title="附录 F. 版权信息">
<link rel="index" href="the.index.html" title="索引">
<link rel="subsection" href="zend.form.forms.html#zend.form.forms.plugins" title="23.4.1.  插件加载器">
<link rel="subsection" href="zend.form.forms.html#zend.form.forms.elements" title="23.4.2.  元素（Elements）">
<link rel="subsection" href="zend.form.forms.html#zend.form.forms.displaygroups" title="23.4.3.  显示组（Display Groups）">
<link rel="subsection" href="zend.form.forms.html#zend.form.forms.subforms" title="23.4.4.  子表单">
<link rel="subsection" href="zend.form.forms.html#zend.form.forms.metadata" title="23.4.5.  元数据（Metadata）和属性（Attributes）">
<link rel="subsection" href="zend.form.forms.html#zend.form.forms.decorators" title="23.4.6.  装饰器">
<link rel="subsection" href="zend.form.forms.html#zend.form.forms.validation" title="23.4.7.  校验">
<link rel="subsection" href="zend.form.forms.html#zend.form.forms.methods" title="23.4.8.  方法">
<link rel="subsection" href="zend.form.forms.html#zend.form.forms.config" title="23.4.9.  配置">
<link rel="subsection" href="zend.form.forms.html#zend.form.forms.custom" title="23.4.10.  定制表单">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader"><table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">23.4.  使用 Zend_Form 生成表单 </th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="zend.form.elements.html">上一页</a> </td>
<th width="60%" align="center">第 23 章 Zend_Form</th>
<td width="20%" align="right"> <a accesskey="n" href="zend.form.decorators.html">下一页</a>
</td>
</tr>
</table></div>
<div class="sect1" lang="zh-cn">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="zend.form.forms"></a>23.4.  使用 Zend_Form 生成表单 </h2></div></div></div>
<p>
        <code class="code">Zend_Form</code> 类用来聚合表单元素，显示组和子表单。它可以在这些条目中执行下列动作：
    </p>
<div class="itemizedlist"><ul type="disc">
<li><p>
            校验，包括读取错误代码和消息
        </p></li>
<li><p>
            值聚合，包括组装（populating）条目和从所有条目读取过滤的和未过滤的值
        </p></li>
<li><p>
            迭代所有条目，按它们键入的顺序或者从每个条目中读取的顺序提示来进行
        </p></li>
<li><p>
            解析（rendering）整个表单，通过执行定制解析的单个装饰器（decorator）或者迭代（iterating）表单中的所有条目
        </p></li>
</ul></div>
<p>
        虽然由 <code class="code">Zend_Form</code> 生成的表单可能复杂，可能最好的用法是做简单的表单，但是对于快速程序开发和生成原型（prototyping），它是最好的。
    </p>
<p>
        最基本的事情是实例化一个表单对象：
    </p>
<pre class="programlisting">&lt;?php
// Generic form object:
$form = new Zend_Form();

// Custom form object:
$form = new My_Form()
?&gt;</pre>
<p>
        你可以可选地传递配置参数，它用来设置对象状态以及可能生成新元素：
    </p>
<pre class="programlisting">&lt;?php
// Passing in configuration options:
$form = new Zend_Form($config);
?&gt;</pre>
<p>
        <code class="code">Zend_Form</code> 是可迭代的（iterable），它将按照它们注册的顺序和任何拥有的索引迭代所有元素、显示组和子表单。当你想手动地按适当的顺序解析（render）元素的时候，这个很有用。
    </p>
<p>
        <code class="code">Zend_Form</code> 的魔法在于它能够为元素和显示组提供工厂服务（serve as a factory），并且通过装饰器来解析（render）自己。
    </p>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.form.forms.plugins"></a>23.4.1.  插件加载器 </h3></div></div></div>
<p>
            <code class="code">Zend_Form</code> 利用 <code class="code">Zend_Loader_PluginLoader</code> 使开发者指定替代元素和装饰器的位置。每个表单有和它一起伴随的插件加载器，总访问器用来读取和修改每个表单。
        </p>
<p>
            下列加载器类型和不同的插件加载器方法 'element' 和 'decorator' 一起来使用。类型名大小写敏感。
        </p>
<p>
            用来和插件加载器结合使用的方法如下：
        </p>
<div class="itemizedlist"><ul type="disc">
<li><p>
                <code class="code">setPluginLoader($loader, $type)</code>: $loader 是插件加载器对象自己，type 是上述的类型之一。该方法为给定的类型设置插件加载器为新指定的加载器对象。
            </p></li>
<li><p>
                <code class="code">getPluginLoader($type)</code>: 按类型（$type）来获取插件加载器。
            </p></li>
<li><p>
                <code class="code">addPrefixPath($prefix, $path, $type = null)</code>: 添加一个 prefix/path 结合对给由 $type 指定的加载器。如果 $type 是 null，通过追加前缀给 "_Element" 和 "_Decorator"，它将尝试添加路径给所有的加载器，并用 "Element/" 和 "Decorator/" 追加路径。如果在通用的等级下有所有额外的表单元素类，这是个很方便的给它们设置基础前缀的方法。
            </p></li>
<li><p>
                <code class="code">addPrefixPaths(array $spec)</code>: 允许一次性添加多个路径给一个或多个插件加载器。它需要每个数组元素（item）是一个带有'path'、'prefix'和'type'键的数组。
            </p></li>
</ul></div>
<p>
            另外，也可以用下列方法为所有通过<code class="code">Zend_Form</code>实例生成元素和显示组指定前缀路径：
        </p>
<div class="itemizedlist"><ul type="disc">
<li><p>
                <code class="code">addElementPrefixPath($prefix, $path, $type = null)</code>: 就象 <code class="code">addPrefixPath()</code> 一样，必需指定一个类的前缀和路径。当指定 <code class="code">$type</code>，必需是由 <code class="code">Zend_Form_Element</code> 指定的插件加载器类型之一，更多关于有效 <code class="code">$type</code>值的信息参见 <a href="zend.form.elements.html#zend.form.elements.loaders" title="23.3.1.  插件加载器">element plugins section</a>。如果没有指定 <code class="code">$type</code>，该方法假定它是一个用于所有类型的总的前缀。
            </p></li>
<li><p>
                <code class="code">addDisplayGroupPrefixPath($prefix, $path)</code>: 就象 <code class="code">addPrefixPath()</code> 一样，必需指定一个类的前缀和路径，然而，显示组只支持装饰器作为插件，<code class="code">$type</code> 不是必需的。
            </p></li>
</ul></div>
<p>
            定制元素和装饰器是在表单和封装定制函数之间共享功能的简便方法。在元素文档（elements documentation）中参见 <a href="zend.form.elements.html#zend.form.elements.loaders.customLabel" title="例 23.1.  定制标签">Custom Label example</a> ，看定制元素如何用来替换标准类。
        </p>
</div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.form.forms.elements"></a>23.4.2.  元素（Elements）</h3></div></div></div>
<p>
            <code class="code">Zend_Form</code> 提供了若干访问器用来从表单中添加和删除元素。这些可以获得元素对象实例或以工厂模式来为实例化元素对象自己服务。
        </p>
<p>
            添加元素的最基本的方法是 <code class="code">addElement()</code>。该方法可以或者带有 <code class="code">Zend_Form_Element</code> （或者继承 <code class="code">Zend_Form_Element</code> 的类 ）类型对象的参数，或者用于建立新元素的参数 － 包括元素类型、名称和任何配置选项。
        </p>
<p>
            如一些例子：
        </p>
<pre class="programlisting">&lt;?php
// Using an element instance:
$element = new Zend_Form_Element_Text('foo');
$form-&gt;addElement($element);

// Using a factory
//
// Creates an element of type Zend_Form_Element_Text with the
// name of 'foo':
$form-&gt;addElement('text', 'foo');

// Pass label option to the element:
$form-&gt;addElement('text', 'foo', array('label' =&gt; 'Foo:'));
?&gt;</pre>
<div class="note"><table border="0" summary="Note: addElement() 实现 Fluent Interface">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[注意]" src="images/note.png"></td>
<th align="left">addElement() 实现 Fluent Interface</th>
</tr>
<tr><td align="left" valign="top">
<p>
                <code class="code">addElement()</code> 实现一个 fluent interface，就是说，它返回 <code class="code">Zend_Form</code> 对象，而不是元素。这样做来允许你把多个 addElement()方法或者其它实现 fluent interface 的表单方法链接起来（所有 Zend_Form 中的设置器（ setters） 都实现这个模式）。
            </p>
<p>
                如果你想返回元素，使用 <code class="code">createElement()</code>，下面是要点。然而请注意，<code class="code">createElement()</code> 不把元素加到表单上。
            </p>
<p>
                在内部，<code class="code">addElement()</code> 实际上用 <code class="code">createElement()</code> 来生成元素之后把它加到表单上。
            </p>
</td></tr>
</table></div>
<p>
            一旦元素被添加到表单，可以用名字来读取。通过使用 <code class="code">getElement()</code> 方法或者通过重载（overloading）使元素作为对象属性来访问：
        </p>
<pre class="programlisting">&lt;?php
// getElement():
$foo = $form-&gt;getElement('foo');

// As object property:
$foo = $form-&gt;foo;
?&gt;</pre>
<p>
            偶尔地，你只想生成一个元素并不想把它加到表单上（例如，你想利用众多的用表单注册的插件路径，但稍后把这些对象加到子表单上）。<code class="code">createElement()</code> 方法可以完成这些：
        </p>
<pre class="programlisting">&lt;?php
// $username becomes a Zend_Form_Element_Text object:
$username = $form-&gt;createElement('text', 'username');
?&gt;</pre>
<div class="sect3" lang="zh-cn">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.form.forms.elements.values"></a>23.4.2.1.  组装和读取数值 </h4></div></div></div>
<p>
                校验表单之后，你一般需要读取它的数值以便执行其它操作，如更新数据库或通知一个 web 服务。你可以通过 <code class="code">getValues()</code> 来读取所有元素的值，<code class="code">getValue($name)</code> 可以通过名字来读取一个单个的值：
            </p>
<pre class="programlisting">&lt;?php
// Get all values:
$values = $form-&gt;getValues();

// Get only 'foo' element's value:
$value = $form-&gt;getValue('foo');
?&gt;</pre>
<p>
                有时候，在解析之前，你想用特定的值来组装表单，可以通过 <code class="code">setDefaults()</code> 或 <code class="code">populate()</code> 方法来完成：
            </p>
<pre class="programlisting">&lt;?php
$form-&gt;setDefaults($data);
$form-&gt;populate($data);
?&gt;</pre>
<p>
                在另一面，你可能想在组装和校验之前清除一个表单，可使用 <code class="code">reset()</code> 方法来完成：
            </p>
<pre class="programlisting">
$form-&gt;reset();
</pre>
</div>
<div class="sect3" lang="zh-cn">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.form.forms.elements.global"></a>23.4.2.2.  全局操作 </h4></div></div></div>
<p>
                偶尔，你想用对所有元素进行特定的操作，一般的情形包括需要为所有元素设置插件前缀路径、装饰器和过滤器，如下例：
            </p>
<div class="example">
<a name="zend.form.forms.elements.global.allpaths"></a><p class="title"><b>例 23.2.  为所有元素设置前缀路径 </b></p>
<div class="example-contents">
<p>
                    可以通过类型来为所有的元素设置前缀路径，或者使用全局前缀，如这些例子：
                </p>
<pre class="programlisting">&lt;?php
// Set global prefix path:
// Creates paths for prefixes My_Foo_Filter, My_Foo_Validate,
// and My_Foo_Decorator
$form-&gt;addElementPrefixPath('My_Foo', 'My/Foo/');

// Just filter paths:
$form-&gt;addElementPrefixPath('My_Foo_Filter', 'My/Foo/Filter', 'filter');

// Just validator paths:
$form-&gt;addElementPrefixPath('My_Foo_Validate', 'My/Foo/Validate', 'validate');

// Just decorator paths:
$form-&gt;addElementPrefixPath('My_Foo_Decorator', 'My/Foo/Decorator', 'decorator');
?&gt;</pre>
</div>
</div>
<br class="example-break"><div class="example">
<a name="zend.form.forms.elements.global.decorators"></a><p class="title"><b>例 23.3.  为所有元素设置装饰器（Decorators）</b></p>
<div class="example-contents">
<p>
                    你可以为所有元素设置装饰器。<code class="code">setElementDecorators()</code> 接受一个装饰器数组， 就象 <code class="code">setDecorators()</code> 一样，并对每个元素重写（overwrite）先前设置的装饰器。在本例中，我们为 ViewHelper 和一个 Label 设置装饰器：
                </p>
<pre class="programlisting">&lt;?php
$form-&gt;setElementDecorators(array(
    'ViewHelper',
    'Label'
));
?&gt;</pre>
</div>
</div>
<br class="example-break"><div class="example">
<a name="zend.form.forms.elements.global.decoratorsFilter"></a><p class="title"><b>例 23.4.  为某些元素设置装饰器 </b></p>
<div class="example-contents">
<p>
                    你也可以对一个元素的子集设置装饰器，包含和排除都可以。
                    <code class="code">setElementDecorators()</code> 的第二个参数可以是元素名数组；
                    缺省地，指定这样一个数组将只对这些元素设置指定的装饰器。
                    你也可以传递第三个参数，用来指示是包含还是排除这个元素列表的标志。
                    如果是 false，它将装饰 <span class="emphasis"><em>除了</em></span> 这些在列表中的元素 <span class="emphasis"><em>之外</em></span>
                    的所有元素。使用方法的标准用法，在每个元素中，任何传递的装饰器将覆盖任何先前设置的装饰器。
                </p>
<p>
                    在下面的片段中，我们只对 'foo' 和 'bar' 元素使用视图助手和标签装饰器：
                </p>
<pre class="programlisting">
$form-&gt;setElementDecorators(
    array(
        'ViewHelper',
        'Label'
    ),
    array(
        'foo',
        'bar'
    )
);
</pre>
<p>
                    另一方面，在这个片段中，我们对<span class="emphasis"><em>除了</em></span>'foo' 元素 'bar'<span class="emphasis"><em>之外</em></span>的所以元素使用视图助手和标签装饰器：
                </p>
<pre class="programlisting">
$form-&gt;setElementDecorators(
    array(
        'ViewHelper',
        'Label'
    ),
    array(
        'foo',
        'bar'
    ),
    false
);
</pre>
</div>
</div>
<br class="example-break"><div class="note"><table border="0" summary="Note:  有些装饰器不适合某些元素 ">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[注意]" src="images/note.png"></td>
<th align="left"> 有些装饰器不适合某些元素 </th>
</tr>
<tr><td align="left" valign="top">
<p>
                        虽然 <code class="code">setElementDecorators()</code> 可能是个好方案，但有时候不会得到所期望的结果。例如，各种各样的按钮元素（Submit, Button, Reset）。当前使用标签（label）作为按钮（button）的值（value），并只使用 ViewHelper 和 DtDdWrapper 装饰器 －－ 防止解析另外的标签、错误、和提示，上述例子可能重复（duplicate）一些内容（标签）。
                    </p>
<p>
                        你可以使用 包含/排除 数组来克服在前面例子中所述的问题。
                    </p>
<p>
                        所以，要灵活使用这个方法，你需要排除或手工修改一些元素的装饰器来防止不希望的输出。
                    </p>
</td></tr>
</table></div>
<div class="example">
<a name="zend.form.forms.elements.global.filters"></a><p class="title"><b>例 23.5.  为所有元素设置过滤器 </b></p>
<div class="example-contents">
<p>
                    大多数情况下，你想对所有元素应用同一个过滤器，一个通常的用法是 <code class="code">修整（trim()）</code> 所有的值：
                </p>
<pre class="programlisting">&lt;?php
$form-&gt;setElementFilters(array('StringTrim'));
?&gt;</pre>
</div>
</div>
<br class="example-break">
</div>
<div class="sect3" lang="zh-cn">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.form.forms.elements.methods"></a>23.4.2.3.  和元素交互使用的方法 </h4></div></div></div>
<p>
                下面的方法用来和元素交互使用：
            </p>
<div class="itemizedlist"><ul type="disc">
<li><p>
                    <code class="code">createElement($element, $name = null, $options = null)</code>
                </p></li>
<li><p>
                    <code class="code">addElement($element, $name = null, $options = null)</code>
                </p></li>
<li><p>
                    <code class="code">addElements(array $elements)</code>
                </p></li>
<li><p>
                    <code class="code">setElements(array $elements)</code>
                </p></li>
<li><p>
                    <code class="code">getElement($name)</code>
                </p></li>
<li><p>
                    <code class="code">getElements()</code>
                </p></li>
<li><p>
                    <code class="code">removeElement($name)</code>
                </p></li>
<li><p>
                    <code class="code">clearElements()</code>
                </p></li>
<li><p>
                    <code class="code">setDefaults(array $defaults)</code>
                </p></li>
<li><p>
                    <code class="code">setDefault($name, $value)</code>
                </p></li>
<li><p>
                    <code class="code">getValue($name)</code>
                </p></li>
<li><p>
                    <code class="code">getValues()</code>
                </p></li>
<li><p>
                    <code class="code">getUnfilteredValue($name)</code>
                </p></li>
<li><p>
                    <code class="code">getUnfilteredValues()</code>
                </p></li>
<li><p>
                    <code class="code">setElementFilters(array $filters)</code>
                </p></li>
<li><p>
                    <code class="code">setElementDecorators(array $decorators)</code>
                </p></li>
<li><p>
                    <code class="code">addElementPrefixPath($prefix, $path, $type = null)</code>
                </p></li>
<li><p>
                    <code class="code">addElementPrefixPaths(array $spec)</code>
                </p></li>
</ul></div>
</div>
</div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.form.forms.displaygroups"></a>23.4.3.  显示组（Display Groups）</h3></div></div></div>
<p>
            显示组是生成要显示的虚拟元素组的一种方法。所有元素在表单中保持用名字可访问，但是当迭代或解析（rendering）所有表单的时候，任何在显示组中的元素将被一起解析（rendered）。最普通的用例是把（数据库表中的）字段组成一组元素。
        </p>
<p>
            显示组的基本类是 <code class="code">Zend_Form_DisplayGroup</code>。虽然它可以直接实例化，但是一般最好是用 <code class="code">Zend_Form</code> 的 <code class="code">addDisplayGroup()</code> 方法来做。该方法带有一个元素数组作为第一个参数，和一个显示组的名称作为第二个参数。也可以传递一个选项数组或 <code class="code">Zend_Config</code> 对象作为第三个参数。
        </p>
<p>
            假定元素 'username' 和 'password'已经在表单中，下面的代码将把它们组成一个 'login'显示组：
        </p>
<pre class="programlisting">&lt;?php
$form-&gt;addDisplayGroup(array('username', 'password'), 'login');
?&gt;</pre>
<p>
            你可以用 <code class="code">getDisplayGroup()</code> 方法来访问显示组，或用显示组的名称来重载（overloading）：
        </p>
<pre class="programlisting">&lt;?php
// Using getDisplayGroup():
$login = $form-&gt;getDisplayGroup('login');

// Using overloading:
$login = $form-&gt;login;
?&gt;</pre>
<div class="note"><table border="0" summary="Note:  不需要加载缺省的装饰器 ">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[注意]" src="images/note.png"></td>
<th align="left"> 不需要加载缺省的装饰器 </th>
</tr>
<tr><td align="left" valign="top">
<p>
                缺省地，缺省的装饰器在对象初始化过程中加载。你可以在生成显示组的时候通过传递 'disableLoadDefaultDecorators' 选项来关闭（disable）它。
            </p>
<pre class="programlisting">&lt;?php
$form-&gt;addDisplayGroup(
    array('foo', 'bar'),
    'foobar',
    array('disableLoadDefaultDecorators' =&gt; true)
);
</pre>
<p>
                该选项可以和其它选项混合，它们都是数组或者 <code class="code">Zend_Config</code> 对象。
            </p>
</td></tr>
</table></div>
<div class="sect3" lang="zh-cn">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.form.forms.displaygroups.global"></a>23.4.3.1.  全局操作 </h4></div></div></div>
<p>
                就像对元素一样，一些操作可能影响所有的显示组，包括设置装饰器和寻找装饰器的插件路径。
            </p>
<div class="example">
<a name="zend.form.forms.displaygroups.global.paths"></a><p class="title"><b>例 23.6.  为所有的显示组设置装饰器前缀路径 </b></p>
<div class="example-contents">
<p>
                    缺省地，显示组继承表单所使用的任何一个装饰器的路径，然而，如果它们在另外的位置，可以使用这个方法：<code class="code">addDisplayGroupPrefixPath()</code>。
                </p>
<pre class="programlisting">&lt;?php
$form-&gt;addDisplayGroupPrefixPath('My_Foo_Decorator', 'My/Foo/Decorator');
?&gt;</pre>
</div>
</div>
<br class="example-break"><div class="example">
<a name="zend.form.forms.displaygroups.global.decorators"></a><p class="title"><b>例 23.7.  为所有显示组设置装饰器 </b></p>
<div class="example-contents">
<p>
                    你可以为所有的显示组设置装饰器。<code class="code">setDisplayGroupDecorators()</code> 接受一个装饰器数组，就像 <code class="code">setDecorators()</code> 一样，并将在每个显示组重写（overwrite）先前设置的装饰器。在这个例子中，我们给字段（为确保元素被迭代，FormElements 装饰器是必需的）设置装饰器：
                </p>
<pre class="programlisting">&lt;?php
$form-&gt;setDisplayGroupDecorators(array(
    'FormElements',
    'Fieldset'
));
?&gt;</pre>
</div>
</div>
<br class="example-break">
</div>
<div class="sect3" lang="zh-cn">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.form.forms.displaygroups.customClasses"></a>23.4.3.2.  使用定制的显示组类 </h4></div></div></div>
<p>
                缺省地，<code class="code">Zend_Form</code> 为显示组使用 <code class="code">Zend_Form_DisplayGroup</code> 类，你可能需要继承这个类来提供定制的功能。<code class="code">addDisplayGroup()</code> 不允许传递一个具体的实例，但确实允许用 'displayGroupClass' 键来指定一个类来作为它的一个选项：
            </p>
<pre class="programlisting">&lt;?php
// Use the 'My_DisplayGroup' class
$form-&gt;addDisplayGroup(
    array('username', 'password'),
    'user',
    array('displayGroupClass' =&gt; 'My_DisplayGroup')
);
?&gt;</pre>
<p>
                如果类没有加载，<code class="code">Zend_Form</code> 将用 <code class="code">Zend_Loader</code> 来加载。
            </p>
<p>
                你也可以指定一个缺省的显示组类来和表单一起使用，这样所有用这个表单对象生成的显示组将使用那个类：
            </p>
<pre class="programlisting">&lt;?php
// Use the 'My_DisplayGroup' class for all display groups:
$form-&gt;setDefaultDisplayGroupClass('My_DisplayGroup');
?&gt;</pre>
<p>
                这个设置可能在配置中指定为 'defaultDisplayGroupClass'，并在早期加载以确保所有的显示组使用那个类。
            </p>
</div>
<div class="sect3" lang="zh-cn">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.form.forms.displaygroups.interactionmethods"></a>23.4.3.3.  和显示组交互使用的方法 </h4></div></div></div>
<p>
                下列方法用来和显示组一起交互使用：
            </p>
<div class="itemizedlist"><ul type="disc">
<li><p>
                    <code class="code">addDisplayGroup(array $elements, $name, $options = null)</code>
                </p></li>
<li><p>
                    <code class="code">addDisplayGroups(array $groups)</code>
                </p></li>
<li><p>
                    <code class="code">setDisplayGroups(array $groups)</code>
                </p></li>
<li><p>
                    <code class="code">getDisplayGroup($name)</code>
                </p></li>
<li><p>
                    <code class="code">getDisplayGroups()</code>
                </p></li>
<li><p>
                    <code class="code">removeDisplayGroup($name)</code>
                </p></li>
<li><p>
                    <code class="code">clearDisplayGroups()</code>
                </p></li>
<li><p>
                    <code class="code">setDisplayGroupDecorators(array $decorators)</code>
                </p></li>
<li><p>
                    <code class="code">addDisplayGroupPrefixPath($prefix, $path)</code>
                </p></li>
<li><p>
                    <code class="code">setDefaultDisplayGroupClass($class)</code>
                </p></li>
<li><p>
                    <code class="code">getDefaultDisplayGroupClass($class)</code>
                </p></li>
</ul></div>
</div>
<div class="sect3" lang="zh-cn">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.form.forms.displaygroups.methods"></a>23.4.3.4. Zend_Form_DisplayGroup 方法 </h4></div></div></div>
<p>
                <code class="code">Zend_Form_DisplayGroup</code> 有下列方法，以类来分组：
            </p>
<div class="itemizedlist"><ul type="disc">
<li>
<p>Configuration:</p>
<div class="itemizedlist"><ul type="circle">
<li><p><code class="code">setOptions(array $options)</code></p></li>
<li><p><code class="code">setConfig(Zend_Config $config)</code></p></li>
</ul></div>
</li>
<li>
<p>Metadata:</p>
<div class="itemizedlist"><ul type="circle">
<li><p><code class="code">setAttrib($key, $value)</code></p></li>
<li><p><code class="code">addAttribs(array $attribs)</code></p></li>
<li><p><code class="code">setAttribs(array $attribs)</code></p></li>
<li><p><code class="code">getAttrib($key)</code></p></li>
<li><p><code class="code">getAttribs()</code></p></li>
<li><p><code class="code">removeAttrib($key)</code></p></li>
<li><p><code class="code">clearAttribs()</code></p></li>
<li><p><code class="code">setName($name)</code></p></li>
<li><p><code class="code">getName()</code></p></li>
<li><p><code class="code">setDescription($value)</code></p></li>
<li><p><code class="code">getDescription()</code></p></li>
<li><p><code class="code">setLegend($legend)</code></p></li>
<li><p><code class="code">getLegend()</code></p></li>
<li><p><code class="code">setOrder($order)</code></p></li>
<li><p><code class="code">getOrder()</code></p></li>
</ul></div>
</li>
<li>
<p>Elements:</p>
<div class="itemizedlist"><ul type="circle">
<li><p><code class="code">createElement($type, $name, array $options = array())</code></p></li>
<li><p><code class="code">addElement($typeOrElement, $name, array $options = array())</code></p></li>
<li><p><code class="code">addElements(array $elements)</code></p></li>
<li><p><code class="code">setElements(array $elements)</code></p></li>
<li><p><code class="code">getElement($name)</code></p></li>
<li><p><code class="code">getElements()</code></p></li>
<li><p><code class="code">removeElement($name)</code></p></li>
<li><p><code class="code">clearElements()</code></p></li>
</ul></div>
</li>
<li>
<p>Plugin loaders:</p>
<div class="itemizedlist"><ul type="circle">
<li><p><code class="code">setPluginLoader(Zend_Loader_PluginLoader $loader)</code></p></li>
<li><p><code class="code">getPluginLoader()</code></p></li>
<li><p><code class="code">addPrefixPath($prefix, $path)</code></p></li>
<li><p><code class="code">addPrefixPaths(array $spec)</code></p></li>
</ul></div>
</li>
<li>
<p>Decorators:</p>
<div class="itemizedlist"><ul type="circle">
<li><p><code class="code">addDecorator($decorator, $options = null)</code></p></li>
<li><p><code class="code">addDecorators(array $decorators)</code></p></li>
<li><p><code class="code">setDecorators(array $decorators)</code></p></li>
<li><p><code class="code">getDecorator($name)</code></p></li>
<li><p><code class="code">getDecorators()</code></p></li>
<li><p><code class="code">removeDecorator($name)</code></p></li>
<li><p><code class="code">clearDecorators()</code></p></li>
</ul></div>
</li>
<li>
<p>Rendering:</p>
<div class="itemizedlist"><ul type="circle">
<li><p><code class="code">setView(Zend_View_Interface $view = null)</code></p></li>
<li><p><code class="code">getView()</code></p></li>
<li><p><code class="code">render(Zend_View_Interface $view = null)</code></p></li>
</ul></div>
</li>
<li>
<p>I18n:</p>
<div class="itemizedlist"><ul type="circle">
<li><p><code class="code">setTranslator(Zend_Translate_Adapter $translator = null)</code></p></li>
<li><p><code class="code">getTranslator()</code></p></li>
<li><p><code class="code">setDisableTranslator($flag)</code></p></li>
<li><p><code class="code">translatorIsDisabled()</code></p></li>
</ul></div>
</li>
</ul></div>
</div>
</div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.form.forms.subforms"></a>23.4.4.  子表单 </h3></div></div></div>
<p>
            子表单服务于如干目的：
        </p>
<div class="itemizedlist"><ul type="disc">
<li><p>
                生成逻辑元素组。因为子表单只是个表单，你可以把它当作独立的实体来校验。
            </p></li>
<li><p>
                生成多页表单。因为子表单只是个表单，你可以在每页上显示一个子表单，建立每个子表单都有自己的校验逻辑的多页表单。只有一旦所有的子表单校验了，整个表单才算完整。
            </p></li>
<li><p>
                成组地显示。像显示组一样，当子表单作为大表单的一部分解析，可以被用做组元素。然而要小心，主表单对象不知道子表单中的元素。
            </p></li>
</ul></div>
<p>
            子表单可以是 <code class="code">Zend_Form</code> 对象，或者更一般地是 <code class="code">Zend_Form_SubForm</code> 对象。后者包含适合包含在大表单（例如，它不解析另外的 HTML 表单标签，但解析组元素）里的装饰器。为了加上子表单，简单地把它添加到一个表单并给出名字：
        </p>
<pre class="programlisting">&lt;?php
$form-&gt;addSubForm($subForm, 'subform');
?&gt;</pre>
<p>
            可以用 <code class="code">getSubForm($name)</code> 或用子表单名重载（overloading）它来读取子表单：
        </p>
<pre class="programlisting">&lt;?php
// Using getSubForm():
$subForm = $form-&gt;getSubForm('subform');

// Using overloading:
$subForm = $form-&gt;subform;
?&gt;</pre>
<p>
            虽然子表单包含的元素不包含在表单迭代中，但子表单包含在其中。
        </p>
<div class="sect3" lang="zh-cn">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.form.forms.subforms.global"></a>23.4.4.1.  全局操作 </h4></div></div></div>
<p>
                像元素和显示组一样，有些操作可以影响所有的子表单。然而不像显示组和元素，子表单从主表单对象继承了最多的功能，并且唯一的需要全局执行的操作是为子表单设置装饰器，<code class="code">setSubFormDecorators()</code> 方法来完成此任务。在下一个例子中，我们将为所有作为字段（为确保迭代它的元素，FormElements 装饰器是必需的）的子表单设置装饰器：
            </p>
<pre class="programlisting">&lt;?php
$form-&gt;setSubFormDecorators(array(
    'FormElements',
    'Fieldset'
));
?&gt;</pre>
</div>
<div class="sect3" lang="zh-cn">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.form.forms.subforms.methods"></a>23.4.4.2.  和子表单交互使用的方法 </h4></div></div></div>
<p>
                下列方法用来和子表单交互使用：
            </p>
<div class="itemizedlist"><ul type="disc">
<li><p>
                    <code class="code">addSubForm(Zend_Form $form, $name, $order = null)</code>
                </p></li>
<li><p>
                    <code class="code">addSubForms(array $subForms)</code>
                </p></li>
<li><p>
                    <code class="code">setSubForms(array $subForms)</code>
                </p></li>
<li><p>
                    <code class="code">getSubForm($name)</code>
                </p></li>
<li><p>
                    <code class="code">getSubForms()</code>
                </p></li>
<li><p>
                    <code class="code">removeSubForm($name)</code>
                </p></li>
<li><p>
                    <code class="code">clearSubForms()</code>
                </p></li>
<li><p>
                    <code class="code">setSubFormDecorators(array $decorators)</code>
                </p></li>
</ul></div>
</div>
</div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.form.forms.metadata"></a>23.4.5.  元数据（Metadata）和属性（Attributes）</h3></div></div></div>
<p>
            虽然表单的有效性基本源于它所包含的元素，但它也可以包含其它元数据，如名称（在 HTML 标记语言中经常用作唯一的 ID）、表单动作和方法、许多元素、组、它所包含的子表单和属性元数据（通常用做为表单标签自己设置 HTML 属性）。
        </p>
<p>
            可以使用名字访问器来设置和读取表单的名字：
        </p>
<pre class="programlisting">&lt;?php
// Set the name:
$form-&gt;setName('registration');

// Retrieve the name:
$name = $form-&gt;getName();
?&gt;</pre>
<p>
            为了设置动作（到表单提交的 url ）和方法（提交的方法如 'POST' 或 'GET'），使用动作和方法访问器：
        </p>
<pre class="programlisting">&lt;?php
// Set the action and method:
$form-&gt;setAction('/user/login')
     -&gt;setMethod('post');
?&gt;</pre>
<p>
            你也可以指定特别使用 enctype 访问器的表单编码类型。
            Zend_Form 定义了两个常量，
            <code class="code">Zend_Form::ENCTYPE_URLENCODED</code> 和
            <code class="code">Zend_Form::ENCTYPE_MULTIPART</code>，分别对应值为
            'application/x-www-form-urlencoded' 和
            'multipart/form-data'；
             然而，你可以把它设置为任意的编码类型。
        </p>
<pre class="programlisting">&lt;?php
// Set the action, method, and enctype:
$form-&gt;setAction('/user/login')
     -&gt;setMethod('post')
     -&gt;setEnctype(Zend_Form::ENCTYPE_MULTIPART);
?&gt;</pre>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[注意]" src="images/note.png"></td>
<th align="left">注意</th>
</tr>
<tr><td align="left" valign="top"><p>
                方法、动作和 enctype 只用来内部解析，不用于任何校验。
            </p></td></tr>
</table></div>
<p>
            <code class="code">Zend_Form</code> 实现 <code class="code">Countable</code> 接口，允许把它当作参数传递给计数器（count）：
        </p>
<pre class="programlisting">&lt;?php
$numItems = count($form);
?&gt;</pre>
<p>
            设置任意元数据可通过属性访问器来完成。因为在 <code class="code">Zend_Form</code> 中重载用于访问元素、显示组和子表单，这是唯一的访问元数据的方法。
        </p>
<pre class="programlisting">&lt;?php
// Setting attributes:
$form-&gt;setAttrib('class', 'zend-form')
     -&gt;addAttribs(array(
         'id'       =&gt; 'registration',
         'onSubmit' =&gt; 'validate(this)',
     ));

// Retrieving attributes:
$class = $form-&gt;getAttrib('class');
$attribs = $form-&gt;getAttribs();

// Remove an attribute:
$form-&gt;removeAttrib('onSubmit');

// Clear all attributes:
$form-&gt;clearAttribs();
?&gt;</pre>
</div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.form.forms.decorators"></a>23.4.6.  装饰器 </h3></div></div></div>
<p>
            为表单生成 markup 通常是一件耗时的任务，特别是如果打算重复使用同一个 markup 来显示校验错误、提交的值等。<code class="code">Zend_Form</code> 的解决办法是<span class="emphasis"><em> 装饰器（decorators）</em></span>。
        </p>
<p>
            <code class="code">Zend_Form</code> 对象的装饰器可用来解析表单。FormElements 装饰器将迭代所有在表单中的条目 －－元素、显示组、子表单 －－并解析它们和返回结果。另外，装饰器可以用来封装内容、或追加、或预先准备它。
        </p>
<p>
            <code class="code">Zend_Form</code> 的缺省装饰器是 FormElements，HtmlTag（ 封装在定义列表 ）和 Form，生成它们的等同的代码如下：
        </p>
<pre class="programlisting">&lt;?php
$form-&gt;setDecorators(array(
    'FormElements',
    array('HtmlTag', array('tag' =&gt; 'dl')),
    'Form'
));
?&gt;</pre>
<p>
            生成输出如下：
        </p>
<pre class="programlisting">
&lt;form action="/form/action" method="post"&gt;
&lt;dl&gt;
...
&lt;/dl&gt;
&lt;/form&gt;
</pre>
<p>
            在表单对象中的任何属性设置将用做 <code class="code">&lt;form&gt;</code> 标签的 HTML 属性。
        </p>
<div class="note"><table border="0" summary="Note:  不需要加载缺省的装饰器 ">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[注意]" src="images/note.png"></td>
<th align="left"> 不需要加载缺省的装饰器 </th>
</tr>
<tr><td align="left" valign="top">
<p>
                缺省地，缺省的装饰器在对象初始化过程中加载。可通过传递 'disableLoadDefaultDecorators' 选项给构造器来关闭（disable）它：
            </p>
<pre class="programlisting">&lt;?php
$form = new Zend_Form(array('disableLoadDefaultDecorators' =&gt; true));
</pre>
<p>
                该选项可以和其它任何选项混合，它们都是数组或在一个 <code class="code">Zend_Config</code> 对象里。
            </p>
</td></tr>
</table></div>
<div class="note"><table border="0" summary="Note:  使用同类型的多个装饰器 ">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[注意]" src="images/note.png"></td>
<th align="left"> 使用同类型的多个装饰器 </th>
</tr>
<tr><td align="left" valign="top">
<p>
                在内部，当读取装饰器时，<code class="code">Zend_Form</code> 使用装饰器的类做为查找机制。结果，可以注册同类型的多个装饰器，后来的装饰器将重些以前的（装饰器）。
            </p>
<p>
                To get around this,可以使用别名。不用传递装饰器或装饰器名称为第一个参数给 <code class="code">addDecorator()</code>，而是传递一个带有单个元素的、带有指向装饰器对象或名字的别名的数组：
            </p>
<pre class="programlisting">&lt;?php
// Alias to 'FooBar':
$form-&gt;addDecorator(array('FooBar' =&gt; 'HtmlTag'), array('tag' =&gt; 'div'));

// And retrieve later:
$form = $element-&gt;getDecorator('FooBar');
?&gt;</pre>
<p>
                在 <code class="code">addDecorators()</code> 和 <code class="code">setDecorators()</code> 方法中，需要传递在表示装饰器的数组中的 'decorator' 选项：
            </p>
<pre class="programlisting">&lt;?php
// Add two 'HtmlTag' decorators, aliasing one to 'FooBar':
$form-&gt;addDecorators(
    array('HtmlTag', array('tag' =&gt; 'div')),
    array(
        'decorator' =&gt; array('FooBar' =&gt; 'HtmlTag'),
        'options' =&gt; array('tag' =&gt; 'dd')
    ),
);

// And retrieve later:
$htmlTag = $form-&gt;getDecorator('HtmlTag');
$fooBar  = $form-&gt;getDecorator('FooBar');
?&gt;</pre>
</td></tr>
</table></div>
<p>
            为生成表单，你可以生成自己的装饰器。一个通常的用例是如果你知道额外的你想用的 HTML，你的装饰器可以潜在地使用从独立的元素或显示组来的装饰器生成额外的 HTML 并返回它。

        </p>
<p>
            下列方法可以用来和装饰器交互使用：
        </p>
<div class="itemizedlist"><ul type="disc">
<li><p>
                    <code class="code">addDecorator($decorator, $options = null)</code>
                </p></li>
<li><p>
                    <code class="code">addDecorators(array $decorators)</code>
                </p></li>
<li><p>
                    <code class="code">setDecorators(array $decorators)</code>
                </p></li>
<li><p>
                    <code class="code">getDecorator($name)</code>
                </p></li>
<li><p>
                    <code class="code">getDecorators()</code>
                </p></li>
<li><p>
                    <code class="code">removeDecorator($name)</code>
                </p></li>
<li><p>
                    <code class="code">clearDecorators()</code>
                </p></li>
</ul></div>
</div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.form.forms.validation"></a>23.4.7.  校验 </h3></div></div></div>
<p>
            表单的一个基本用例是校验提交的数据。<code class="code">Zend_Form</code> 让你一次性校验整个表单或部分表单，还有对 XmlHttpRequests (AJAX)的自动校验响应。如果提交的数据无效，它有一些方法用来为元素和子表单校验失败而读取各种各样的错误代码和消息。
        </p>
<p>
            为了校验整个表单，使用  <code class="code">isValid()</code> 方法：
        </p>
<pre class="programlisting">&lt;?php
if (!$form-&gt;isValid($_POST)) {
    // failed validation
}
?&gt;</pre>
<p>
            <code class="code">isValid()</code> 校验每个必需的元素和任何包括在提交的数据中的非必需的元素。
        </p>
<p>
            有时候你可能只需要校验数据的一个子集，可以使用 <code class="code">isValidPartial($data)</code>：
        </p>
<pre class="programlisting">&lt;?php
if (!$form-&gt;isValidPartial($data)) {
    // failed validation
}
?&gt;</pre>
<p>
            <code class="code">isValidPartial()</code> 只尝试校验那些数据中匹配的元素，如果某个元素不在数据中，那就跳过。
        </p>
<p>
            当为 AJAX 请求校验元素或元素组，你一般要校验表单的一个子集，并想要响应返回到 JSON。用 <code class="code">processAjax()</code> 正好：
        </p>
<pre class="programlisting">&lt;?php
$json = $form-&gt;processAjax($data);
?&gt;</pre>
<p>
            你可以发送 JSON 响应到客户端。如果表单有效，这将是个布尔 true 响应，如果表单无效，则是个包含 key/message 对的 javascript 对象，这里，每个 'message' 是校验错误消息的数组。
        </p>
<p>
            对于校验失败的表单，你可以分别使用 <code class="code">getErrors()</code> 和 <code class="code">getMessages()</code> 获取错误代码和错误消息：
        </p>
<pre class="programlisting">&lt;?php
$codes = $form-&gt;getErrors();
$messages = $form-&gt;getMessage();
?&gt;</pre>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[注意]" src="images/note.png"></td>
<th align="left">注意</th>
</tr>
<tr><td align="left" valign="top"><p>
                因为由 <code class="code">getMessages()</code> 返回的消息是 error code/message 对的数组，一般不需要 <code class="code">getErrors()</code>。
            </p></td></tr>
</table></div>
<p>
            你可以通过传递元素名为单个元素来获取代码和错误消息；
        </p>
<pre class="programlisting">&lt;?php
$codes = $form-&gt;getErrors('username');
$messages = $form-&gt;getMessages('username');
?&gt;</pre>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[注意]" src="images/note.png"></td>
<th align="left">注意</th>
</tr>
<tr><td align="left" valign="top"><p>
                注意：当校验元素时，<code class="code">Zend_Form</code> 发送第二个参数给每个元素的 <code class="code">isValid()</code> 方法：被校验的数据的数组。当确定数据和合法性时，单个的校验器可以用这个来让它们来利用其它提交的值。一个典型的例子是注册表单，密码和密码确认都是必需的；密码元素可以使用密码确认做为它的校验的一部分。
            </p></td></tr>
</table></div>
<div class="sect3" lang="zh-cn">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.form.forms.validation.errors"></a>23.4.7.1.  定制错误消息 </h4></div></div></div>
<p>
                有时，你想定制一条或多条特定的错误消息来替代由附加到元素上的校验器所带的错误消息。
                另外，有时候你想自己标记表单无效，从 1.6.0 版开始，通过下列方法来实现这个功能。
            </p>
<div class="itemizedlist"><ul type="disc">
<li><p>
                    <code class="code">addErrorMessage($message)</code>: 添加一条来显示当校验失败时的错误消息。
                    可以多次调用，新消息就追加到堆栈。
                </p></li>
<li><p>
                    <code class="code">addErrorMessages(array $messages)</code>: 添加多条错误消息来显示校验错误。
                </p></li>
<li><p>
                    <code class="code">setErrorMessages(array $messages)</code>: 添加多条错误消息来显示校验错误，并覆盖先前的错误消息。
                </p></li>
<li><p>
                    <code class="code">getErrorMessages()</code>: 读取已定义的定制的错误消息列表。
                </p></li>
<li><p>
                    <code class="code">clearErrorMessages()</code>: 删除已定义的定制的错误消息。
                </p></li>
<li><p>
                    <code class="code">markAsError()</code>: 标记表单已经有失败的校验。
                </p></li>
<li><p>
                    <code class="code">addError($message)</code>: 添加一条消息给定制错误消息栈并标记表单无效。
                </p></li>
<li><p>
                    <code class="code">addErrors(array $messages)</code>: 添加数条消息给定制错误消息栈并标记表单无效。
                </p></li>
<li><p>
                    <code class="code">setErrors(array $messages)</code>: 覆盖定制的错误消息堆栈并标记表单无效。
                </p></li>
</ul></div>
<p>
                所有用这个方式设置的错误可以被翻译。
          另外，你可以插入占位符 "%value%" 来表示元素的值；当读取到错误消息时，这个当前元素值将被替换。
            </p>
</div>
</div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.form.forms.methods"></a>23.4.8.  方法 </h3></div></div></div>
<p>
            下面是 <code class="code">Zend_Form</code> 的方法大全，按类分组：
        </p>
<div class="itemizedlist"><ul type="disc">
<li>
<p> 配置和选项：</p>
<div class="itemizedlist"><ul type="circle">
<li><p><code class="code">setOptions(array $options)</code></p></li>
<li><p><code class="code">setConfig(Zend_Config $config)</code></p></li>
</ul></div>
</li>
<li>
<p> 插件加载器和路径：</p>
<div class="itemizedlist"><ul type="circle">
<li><p><code class="code">setPluginLoader(Zend_Loader_PluginLoader_Interface $loader, $type = null)</code></p></li>
<li><p><code class="code">getPluginLoader($type = null)</code></p></li>
<li><p><code class="code">addPrefixPath($prefix, $path, $type = null) </code></p></li>
<li><p><code class="code">addPrefixPaths(array $spec)</code></p></li>
<li><p><code class="code">addElementPrefixPath($prefix, $path, $type = null)</code></p></li>
<li><p><code class="code">addElementPrefixPaths(array $spec)</code></p></li>
<li><p><code class="code">addDisplayGroupPrefixPath($prefix, $path)</code></p></li>
</ul></div>
</li>
<li>
<p> 元数据: </p>
<div class="itemizedlist"><ul type="circle">
<li><p><code class="code">setAttrib($key, $value)</code></p></li>
<li><p><code class="code">addAttribs(array $attribs)</code></p></li>
<li><p><code class="code">setAttribs(array $attribs)</code></p></li>
<li><p><code class="code">getAttrib($key)</code></p></li>
<li><p><code class="code">getAttribs()</code></p></li>
<li><p><code class="code">removeAttrib($key)</code></p></li>
<li><p><code class="code">clearAttribs()</code></p></li>
<li><p><code class="code">setAction($action)</code></p></li>
<li><p><code class="code">getAction()</code></p></li>
<li><p><code class="code">setMethod($method)</code></p></li>
<li><p><code class="code">getMethod()</code></p></li>
<li><p><code class="code">setName($name)</code></p></li>
<li><p><code class="code">getName()</code></p></li>
</ul></div>
</li>
<li>
<p> 元素：</p>
<div class="itemizedlist"><ul type="circle">
<li><p><code class="code">addElement($element, $name = null, $options = null)</code></p></li>
<li><p><code class="code">addElements(array $elements)</code></p></li>
<li><p><code class="code">setElements(array $elements)</code></p></li>
<li><p><code class="code">getElement($name)</code></p></li>
<li><p><code class="code">getElements()</code></p></li>
<li><p><code class="code">removeElement($name)</code></p></li>
<li><p><code class="code">clearElements()</code></p></li>
<li><p><code class="code">setDefaults(array $defaults)</code></p></li>
<li><p><code class="code">setDefault($name, $value)</code></p></li>
<li><p><code class="code">getValue($name)</code></p></li>
<li><p><code class="code">getValues()</code></p></li>
<li><p><code class="code">getUnfilteredValue($name)</code></p></li>
<li><p><code class="code">getUnfilteredValues()</code></p></li>
<li><p><code class="code">setElementFilters(array $filters)</code></p></li>
<li><p><code class="code">setElementDecorators(array $decorators)</code></p></li>
</ul></div>
</li>
<li>
<p> 子表单：</p>
<div class="itemizedlist"><ul type="circle">
<li><p><code class="code">addSubForm(Zend_Form $form, $name, $order = null)</code></p></li>
<li><p><code class="code">addSubForms(array $subForms)</code></p></li>
<li><p><code class="code">setSubForms(array $subForms)</code></p></li>
<li><p><code class="code">getSubForm($name)</code></p></li>
<li><p><code class="code">getSubForms()</code></p></li>
<li><p><code class="code">removeSubForm($name)</code></p></li>
<li><p><code class="code">clearSubForms()</code></p></li>
<li><p><code class="code">setSubFormDecorators(array $decorators)</code></p></li>
</ul></div>
</li>
<li>
<p> 显示组：</p>
<div class="itemizedlist"><ul type="circle">
<li><p><code class="code">addDisplayGroup(array $elements, $name, $options = null)</code></p></li>
<li><p><code class="code">addDisplayGroups(array $groups)</code></p></li>
<li><p><code class="code">setDisplayGroups(array $groups)</code></p></li>
<li><p><code class="code">getDisplayGroup($name)</code></p></li>
<li><p><code class="code">getDisplayGroups()</code></p></li>
<li><p><code class="code">removeDisplayGroup($name)</code></p></li>
<li><p><code class="code">clearDisplayGroups()</code></p></li>
<li><p><code class="code">setDisplayGroupDecorators(array $decorators)</code></p></li>
</ul></div>
</li>
<li>
<p> 校验 </p>
<div class="itemizedlist"><ul type="circle">
<li><p><code class="code">populate(array $values)</code></p></li>
<li><p><code class="code">isValid(array $data)</code></p></li>
<li><p><code class="code">isValidPartial(array $data)</code></p></li>
<li><p><code class="code">processAjax(array $data)</code></p></li>
<li><p><code class="code">persistData()</code></p></li>
<li><p><code class="code">getErrors($name = null)</code></p></li>
<li><p><code class="code">getMessages($name = null)</code></p></li>
</ul></div>
</li>
<li>
<p> 解析：</p>
<div class="itemizedlist"><ul type="circle">
<li><p><code class="code">setView(Zend_View_Interface $view = null)</code></p></li>
<li><p><code class="code">getView()</code></p></li>
<li><p><code class="code">addDecorator($decorator, $options = null)</code></p></li>
<li><p><code class="code">addDecorators(array $decorators)</code></p></li>
<li><p><code class="code">setDecorators(array $decorators)</code></p></li>
<li><p><code class="code">getDecorator($name)</code></p></li>
<li><p><code class="code">getDecorators()</code></p></li>
<li><p><code class="code">removeDecorator($name)</code></p></li>
<li><p><code class="code">clearDecorators()</code></p></li>
<li><p><code class="code">render(Zend_View_Interface $view = null)</code></p></li>
</ul></div>
</li>
<li>
<p>I18n:</p>
<div class="itemizedlist"><ul type="circle">
<li><p><code class="code">setTranslator(Zend_Translate_Adapter $translator = null)</code></p></li>
<li><p><code class="code">getTranslator()</code></p></li>
<li><p><code class="code">setDisableTranslator($flag)</code></p></li>
<li><p><code class="code">translatorIsDisabled()</code></p></li>
</ul></div>
</li>
</ul></div>
</div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.form.forms.config"></a>23.4.9.  配置 </h3></div></div></div>
<p>
            <code class="code">Zend_Form</code> 可以通过 <code class="code">setOptions()</code> 和 <code class="code">setConfig()</code> （或者通过传递选项或 <code class="code">Zend_Config</code> 对象 ） 进行全面配置。使用这些方法，你可以指定表单元素、显示组、装饰器和元数据。
        </p>
<p>
            作为通用的规则，如果 'set' + 选项键涉及 <code class="code">Zend_Form</code> 方法，那么提供的值将传递给那个方法。
            如果访问器不存在，键被假定引用一个属性并将传递给 <code class="code">setAttrib()</code> 。
        </p>
<p>
            规则的异常包括下列这些：
        </p>
<div class="itemizedlist"><ul type="disc">
<li><p>
                    <code class="code">prefixPaths</code> 将传递给 <code class="code">addPrefixPaths()</code>
            </p></li>
<li><p>
                <code class="code">elementPrefixPaths</code> 将传递给 <code class="code">addElementPrefixPaths()</code>
            </p></li>
<li><p>
                <code class="code">displayGroupPrefixPaths</code> 将传递给 <code class="code">addDisplayGroupPrefixPaths()</code>
            </p></li>
<li>
<p> 下列设置器不能用这个方法设置：</p>
<div class="itemizedlist"><ul type="circle">
<li><p><code class="code">setAttrib (though setAttribs *will* work)</code></p></li>
<li><p><code class="code">setConfig</code></p></li>
<li><p><code class="code">setDefault</code></p></li>
<li><p><code class="code">setOptions</code></p></li>
<li><p><code class="code">setPluginLoader</code></p></li>
<li><p><code class="code">setSubForms</code></p></li>
<li><p><code class="code">setTranslator</code></p></li>
<li><p><code class="code">setView</code></p></li>
</ul></div>
</li>
</ul></div>
<p>
            作为一个例子，这里是一个为每个可配置数据传递配置的配置文件：
        </p>
<pre class="programlisting">
[element]
name = "registration"
action = "/user/register"
method = "post"
attribs.class = "zend_form"
attribs.onclick = "validate(this)"

disableTranslator = 0

prefixPath.element.prefix = "My_Element"
prefixPath.element.path = "My/Element/"
elementPrefixPath.validate.prefix = "My_Validate"
elementPrefixPath.validate.path = "My/Validate/"
displayGroupPrefixPath.prefix = "My_Group"
displayGroupPrefixPath.path = "My/Group/"

elements.username.type = "text"
elements.username.options.label = "Username"
elements.username.options.validators.alpha.validator = "Alpha"
elements.username.options.filters.lcase = "StringToLower"
; more elements, of course...

elementFilters.trim = "StringTrim"
;elementDecorators.trim = "StringTrim"

displayGroups.login.elements.username = "username"
displayGroups.login.elements.password = "password"
displayGroupDecorators.elements.decorator = "FormElements"
displayGroupDecorators.fieldset.decorator = "Fieldset"

decorators.elements.decorator = "FormElements"
decorators.fieldset.decorator = "FieldSet"
decorators.fieldset.decorator.options.class = "zend_form"
decorators.form.decorator = "Form"
?&gt;</pre>
<p>
            上述可以很容易被抽象成 XML 或 PHP 基于数组的配置文件。
        </p>
</div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.form.forms.custom"></a>23.4.10.  定制表单 </h3></div></div></div>
<p>
            一个使用基于配置的表单的替代方法是继承 <code class="code">Zend_Form</code> 类，有若干优点：
        </p>
<div class="itemizedlist"><ul type="disc">
<li><p>
                可以容易进行单元测试来确保校验和解析如愿执行。
            </p></li>
<li><p>
                精细地控制每个元素。
            </p></li>
<li><p>
                重使用表单对象，最大化可移植性（不需要跟踪配置文件）。
            </p></li>
<li><p>
                实现定制功能。
            </p></li>
</ul></div>
<p>
            最典型的用例是使用 <code class="code">init()</code> 方法来设置指定的表单元素和配置：
        </p>
<pre class="programlisting">&lt;?php
class My_Form_Login extends Zend_Form
{
    public function init()
    {
        $username = new Zend_Form_Element_Text('username');
        $username-&gt;class = 'formtext';
        $username-&gt;setLabel('Username:')
                 -&gt;setDecorators(array(
                     array('ViewHelper', array('helper' =&gt; 'formText')),
                     array('Label', array('class' =&gt; 'label'))
                 ));

        $password = new Zend_Form_Element_Password('password');
        $password-&gt;class = 'formtext';
        $password-&gt;setLabel('Username:')
                 -&gt;setDecorators(array(
                     array('ViewHelper', array('helper' =&gt; 'formPassword')),
                     array('Label', array('class' =&gt; 'label'))
                 ));

        $submit = new Zend_Form_Element_Submit('login');
        $submit-&gt;class = 'formsubmit';
        $submit-&gt;setValue('Login')
               -&gt;setDecorators(array(
                   array('ViewHelper', array('helper' =&gt; 'formSubmit'))
               ));

        $this-&gt;addElements(array(
            $username,
            $password,
            $submit
        ));

        $this-&gt;setDecorators(array(
            'FormElements',
            'Fieldset',
            'Form'
        ));
    }
}
?&gt;</pre>
<p>
            这个表单可以简单地实例化：
        </p>
<pre class="programlisting">&lt;?php
$form = new My_Form_Login();
?&gt;</pre>
<p>
            所有的功能已经设置并准备好了，不需要配置文件。（注意这个例子非常简化，因为它没有为元素包含校验器和过滤器。）
        </p>
<p>
            另一个普通的扩展原因是定义一组缺省的装饰器，可以通过覆盖（overriding）<code class="code">loadDefaultDecorators()</code> 方法来完成：
        </p>
<pre class="programlisting">&lt;?php
class My_Form_Login extends Zend_Form
{
    public function loadDefaultDecorators()
    {
        $this-&gt;setDecorators(array(
            'FormElements',
            'Fieldset',
            'Form'
        ));
    }
}
</pre>
</div>
</div>
<div class="navfooter"><table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="zend.form.elements.html">上一页</a> </td>
<td width="20%" align="center"><a accesskey="u" href="zend.form.html">上一级</a></td>
<td width="40%" align="right"> <a accesskey="n" href="zend.form.decorators.html">下一页</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">23.3.  使用 Zend_Form_Element 生成表单元素  </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td>
<td width="40%" align="right" valign="top"> 23.5.  使用 Zend_Form_Decorator 生成定制的表单标识（Markup）</td>
</tr>
</table></div>
<div class="revinfo"></div>
</body>
</html>
