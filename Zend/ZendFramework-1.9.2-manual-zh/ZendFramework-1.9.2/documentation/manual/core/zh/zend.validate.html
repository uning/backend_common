<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>第 59 章 Zend_Validate</title>
<link rel="stylesheet" href="dbstyle.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.72.0">
<link rel="start" href="index.html" title="Zend Framework手册 中文版">
<link rel="up" href="index.html" title="Zend Framework手册 中文版">
<link rel="prev" href="zend.uri.html" title="第 58 章 Zend_Uri">
<link rel="next" href="zend.validate.set.html" title="59.2. 标准校验类">
<link rel="chapter" href="introduction.html" title="第 1 章 Zend Framework简介">
<link rel="chapter" href="zend.acl.html" title="第 2 章 Zend_Acl">
<link rel="chapter" href="zend.amf.html" title="第 3 章 Zend_Amf">
<link rel="chapter" href="zend.application.html" title="第 4 章 Zend_Application">
<link rel="chapter" href="zend.auth.html" title="第 5 章 Zend_Auth">
<link rel="chapter" href="zend.cache.html" title="第 6 章 Zend_Cache">
<link rel="chapter" href="zend.captcha.html" title="第 7 章 Zend_Captcha">
<link rel="chapter" href="zend.codegenerator.html" title="第 8 章 Zend_CodeGenerator">
<link rel="chapter" href="zend.config.html" title="第 9 章 Zend_Config">
<link rel="chapter" href="zend.config.writer.html" title="第 10 章 Zend_Config_Writer">
<link rel="chapter" href="zend.console.getopt.html" title="第 11 章 Zend_Console_Getopt">
<link rel="chapter" href="zend.controller.html" title="第 12 章 Zend_Controller">
<link rel="chapter" href="zend.currency.html" title="第 13 章 Zend_Currency">
<link rel="chapter" href="zend.date.html" title="第 14 章 Zend_Date">
<link rel="chapter" href="zend.db.html" title="第 15 章 Zend_Db">
<link rel="chapter" href="zend.debug.html" title="第 16 章 Zend_Debug">
<link rel="chapter" href="zend.dojo.html" title="第 17 章 Zend_Dojo">
<link rel="chapter" href="zend.dom.html" title="第 18 章 Zend_Dom">
<link rel="chapter" href="zend.exception.html" title="第 19 章 Zend_Exception">
<link rel="chapter" href="zend.feed.html" title="第 20 章 Zend_Feed">
<link rel="chapter" href="zend.file.html" title="第 21 章 Zend_File">
<link rel="chapter" href="zend.filter.html" title="第 22 章 Zend_Filter">
<link rel="chapter" href="zend.form.html" title="第 23 章 Zend_Form">
<link rel="chapter" href="zend.gdata.html" title="第 24 章 Zend_Gdata">
<link rel="chapter" href="zend.http.html" title="第 25 章 Zend_Http">
<link rel="chapter" href="zend.infocard.html" title="第 26 章 Zend_InfoCard">
<link rel="chapter" href="zend.json.html" title="第 27 章 Zend_Json">
<link rel="chapter" href="zend.layout.html" title="第 28 章 Zend_Layout">
<link rel="chapter" href="zend.ldap.html" title="第 29 章 Zend_Ldap">
<link rel="chapter" href="zend.loader.html" title="第 30 章 Zend_Loader">
<link rel="chapter" href="zend.locale.html" title="第 31 章 Zend_Locale">
<link rel="chapter" href="zend.log.html" title="第 32 章 Zend_Log">
<link rel="chapter" href="zend.mail.html" title="第 33 章 Zend_Mail">
<link rel="chapter" href="zend.measure.html" title="第 34 章 Zend_Measure">
<link rel="chapter" href="zend.memory.html" title="第 35 章 Zend_Memory">
<link rel="chapter" href="zend.mime.html" title="第 36 章 Zend_Mime">
<link rel="chapter" href="zend.navigation.html" title="第 37 章 Zend_Navigation">
<link rel="chapter" href="zend.openid.html" title="第 38 章 Zend_OpenId">
<link rel="chapter" href="zend.paginator.html" title="第 39 章 Zend_Paginator">
<link rel="chapter" href="zend.pdf.html" title="第 40 章 Zend_Pdf">
<link rel="chapter" href="zend.progressbar.html" title="第 41 章 Zend_ProgressBar">
<link rel="chapter" href="zend.queue.html" title="第 42 章 Zend_Queue">
<link rel="chapter" href="zend.reflection.html" title="第 43 章 Zend_Reflection">
<link rel="chapter" href="zend.registry.html" title="第 44 章 Zend_Registry">
<link rel="chapter" href="zend.rest.html" title="第 45 章 Zend_Rest">
<link rel="chapter" href="zend.search.lucene.html" title="第 46 章 Zend_Search_Lucene">
<link rel="chapter" href="zend.server.html" title="第 47 章 Zend_Server">
<link rel="chapter" href="zend.service.html" title="第 48 章 Zend_Service">
<link rel="chapter" href="zend.session.html" title="第 49 章 Zend_Session">
<link rel="chapter" href="zend.soap.html" title="第 50 章 Zend_Soap">
<link rel="chapter" href="zend.tag.html" title="第 51 章 Zend_Tag">
<link rel="chapter" href="zend.test.html" title="第 52 章 Zend_Test">
<link rel="chapter" href="zend.text.html" title="第 53 章 Zend_Text">
<link rel="chapter" href="zend.timesync.html" title="第 54 章 Zend_TimeSync">
<link rel="chapter" href="zend.tool.framework.html" title="第 55 章 Zend_Tool_Framework">
<link rel="chapter" href="zend.tool.project.html" title="第 56 章 Zend_Tool_Project">
<link rel="chapter" href="zend.translate.html" title="第 57 章 Zend_Translate">
<link rel="chapter" href="zend.uri.html" title="第 58 章 Zend_Uri">
<link rel="chapter" href="zend.validate.html" title="第 59 章 Zend_Validate">
<link rel="chapter" href="zend.version.html" title="第 60 章 Zend_Version">
<link rel="chapter" href="zend.view.html" title="第 61 章 Zend_View">
<link rel="chapter" href="zend.wildfire.html" title="第 62 章 Zend_Wildfire">
<link rel="chapter" href="zend.xmlrpc.html" title="第 63 章 Zend_XmlRpc">
<link rel="chapter" href="zendx.console.process.unix.html" title="第 64 章 ZendX_Console_Process_Unix">
<link rel="chapter" href="zendx.jquery.html" title="第 65 章 ZendX_JQuery">
<link rel="appendix" href="requirements.html" title="附录 A. 系统需求">
<link rel="appendix" href="coding-standard.html" title="附录 B. Zend Framework 的 PHP 编码标准">
<link rel="appendix" href="doc-standard.html" title="附录 C. Zend Framework Documentation Standard">
<link rel="appendix" href="project-structure.html" title="附录 D. Recommended Project Structure for Zend Framework MVC Applications">
<link rel="appendix" href="performance.html" title="附录 E. Zend Framework Performance Guide">
<link rel="appendix" href="copyrights.html" title="附录 F. 版权信息">
<link rel="index" href="the.index.html" title="索引">
<link rel="section" href="zend.validate.html#zend.validate.introduction" title="59.1.  简介">
<link rel="section" href="zend.validate.set.html" title="59.2. 标准校验类">
<link rel="section" href="zend.validate.validator_chains.html" title="59.3. 校验器链">
<link rel="section" href="zend.validate.writing_validators.html" title="59.4. 编写校验器">
<link rel="section" href="zend.validate.messages.html" title="59.5. Validation Messages">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader"><table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">第 59 章 Zend_Validate</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="zend.uri.html">上一页</a> </td>
<th width="60%" align="center"> </th>
<td width="20%" align="right"> <a accesskey="n" href="zend.validate.set.html">下一页</a>
</td>
</tr>
</table></div>
<div class="chapter" lang="zh-cn">
<div class="titlepage"><div><div><h2 class="title">
<a name="zend.validate"></a>第 59 章 Zend_Validate</h2></div></div></div>
<div class="toc">
<p><b>目录</b></p>
<dl>
<dt><span class="sect1"><a href="zend.validate.html#zend.validate.introduction">59.1.  简介 </a></span></dt>
<dd><dl>
<dt><span class="sect2"><a href="zend.validate.html#zend.validate.introduction.definition">59.1.1.  什么是校验器（validator）? </a></span></dt>
<dt><span class="sect2"><a href="zend.validate.html#zend.validate.introduction.using">59.1.2. 校验器的基本用法</a></span></dt>
<dt><span class="sect2"><a href="zend.validate.html#zend.validate.introduction.messages">59.1.3.  定制消息 </a></span></dt>
<dt><span class="sect2"><a href="zend.validate.html#zend.validate.introduction.static">59.1.4.  使用静态 <code class="code">is()</code> 方法 </a></span></dt>
</dl></dd>
<dt><span class="sect1"><a href="zend.validate.set.html">59.2. 标准校验类</a></span></dt>
<dd><dl>
<dt><span class="sect2"><a href="zend.validate.set.html#zend.validate.set.alnum">59.2.1. Alnum</a></span></dt>
<dt><span class="sect2"><a href="zend.validate.set.html#zend.validate.set.alpha">59.2.2. Alpha</a></span></dt>
<dt><span class="sect2"><a href="zend.validate.set.html#zend.validate.set.barcode">59.2.3. Barcode</a></span></dt>
<dt><span class="sect2"><a href="zend.validate.set.html#zend.validate.set.between">59.2.4. Between</a></span></dt>
<dt><span class="sect2"><a href="zend.validate.set.html#zend.validate.set.ccnum">59.2.5. Ccnum</a></span></dt>
<dt><span class="sect2"><a href="zend.validate.set.html#zend.validate.set.date">59.2.6. 日期</a></span></dt>
<dt><span class="sect2"><a href="zend.validate.set.html#zend.validate.set.digits">59.2.7. 数字</a></span></dt>
<dt><span class="sect2"><a href="zend.validate.set.html#zend.validate.set.email_addresses">59.2.8.  Email 地址</a></span></dt>
<dt><span class="sect2"><a href="zend.validate.set.html#zend.validate.set.float">59.2.9. 浮点数</a></span></dt>
<dt><span class="sect2"><a href="zend.validate.set.html#zend.validate.set.greater_than">59.2.10. GreaterThan</a></span></dt>
<dt><span class="sect2"><a href="zend.validate.set.html#zend.validate.set.hex">59.2.11. 十六进制数</a></span></dt>
<dt><span class="sect2"><a href="zend.validate.set.html#zend.validate.set.hostnames">59.2.12. 主机名</a></span></dt>
<dt><span class="sect2"><a href="zend.validate.set.html#zend.validate.set.in_array">59.2.13. InArray</a></span></dt>
<dt><span class="sect2"><a href="zend.validate.set.html#zend.validate.set.int">59.2.14. 整数</a></span></dt>
<dt><span class="sect2"><a href="zend.validate.set.html#zend.validate.set.ip">59.2.15. Ip</a></span></dt>
<dt><span class="sect2"><a href="zend.validate.set.html#zend.validate.set.less_than">59.2.16. LessThan</a></span></dt>
<dt><span class="sect2"><a href="zend.validate.set.html#zend.validate.set.not_empty">59.2.17. NotEmpty</a></span></dt>
<dt><span class="sect2"><a href="zend.validate.set.html#zend.validate.set.regex">59.2.18. Regex</a></span></dt>
<dt><span class="sect2"><a href="zend.validate.set.html#zend.validate.set.string_length">59.2.19. StringLength</a></span></dt>
</dl></dd>
<dt><span class="sect1"><a href="zend.validate.validator_chains.html">59.3. 校验器链</a></span></dt>
<dt><span class="sect1"><a href="zend.validate.writing_validators.html">59.4. 编写校验器</a></span></dt>
<dt><span class="sect1"><a href="zend.validate.messages.html">59.5. Validation Messages</a></span></dt>
<dd><dl><dt><span class="sect2"><a href="zend.validate.messages.html#zend.validate.messages.limitation">59.5.1. Limit the size of a validation message</a></span></dt></dl></dd>
</dl>
</div>
<div class="sect1" lang="zh-cn">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="zend.validate.introduction"></a>59.1.  简介 </h2></div></div></div>
<p>
      Zend_Validate 组件提供一组通用的校验器。它也提供了一个简单的校验器链机制，即在用户定义的顺序下，多个校验器可以被用于单个的数据。
    </p>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.validate.introduction.definition"></a>59.1.1.  什么是校验器（validator）? </h3></div></div></div>
<p>
            校验器根据要求检查它的输入并产生一个布尔结果--是否输入被成功校验。如果输入不符合要求，校验器另外地提供信息来说明输入不符合要求。
        </p>
<p>
            例如，一个 web 应用可能要求一个用户名的长度在6 到12个字符并可能只包含数字和文字。一个校验器可以被用来确保用户名符合要求。如果一个用户名不符合一个或者全部两个要求，知道它到底不符合哪个要求将非常有用。
        </p>
</div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.validate.introduction.using"></a>59.1.2. 校验器的基本用法</h3></div></div></div>
<p>
           用这种方法定义校验为<code class="code">Zend_Validate_Interface</code>提供了基础，它定义了两个方法，<code class="code">isValid()</code> 和 <code class="code">getMessages()</code>。<code class="code">isValid()</code>方法根据提供的值来校验，当且仅当这个值通过校验条件，它返回<code class="code">true</code>。
        </p>
<p>
           如果<code class="code">isValid()</code>返回<code class="code">false</code>，<code class="code">getMessages()</code> 返回一个消息数组来解释校验失败的原因。数组键是识别校验失败原因的短字符串，数组的值是相对应的人类可读的字符串消息。键和值是独立于类的；每个校验类定义它自己的校验失败消息和独一无二的键来识别它们。每个类也有<code class="code">const</code>定义用来为校验失败原因匹配每个识别器。
        </p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[注意]" src="images/note.png"></td>
<th align="left">注意</th>
</tr>
<tr><td align="left" valign="top"><p>
                <code class="code">getMessages()</code> 方法只为最近<code class="code">isValid()</code>的调用返回校验失败消息。对<code class="code">isValid()</code>每个调用清除由前一个<code class="code">isValid()</code>调用导致的任何消息和错误，因为很可能每个<code class="code">isValid()</code>调用用于不同的输入值。
            </p></td></tr>
</table></div>
<p>
            下面的例子示例一个e-mail地址的校验：

            </p>
<pre class="programlisting">&lt;?php
require_once 'Zend/Validate/EmailAddress.php';

$validator = new Zend_Validate_EmailAddress();

if ($validator-&gt;isValid($email)) {
    // email 有效
} else {
    // email 无效; 打印原因
    foreach ($validator-&gt;getMessages() as $messageID =&gt; $message) {
        echo "Validation failure '$messageID': $message\n";
    }
}

            </pre>
<p>

        </p>
</div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.validate.introduction.messages"></a>59.1.3.  定制消息 </h3></div></div></div>
<p>
            校验类提供了一个<code class="code">setMessage()</code>方法，你可以指定校验失败后由<code class="code">getMessages()</code>返回的消息的格式。这个方法的第一个参数是一个包含错误信息的的字符串。你可以在字符串中包含令牌，它将被和校验器相关的数据替换。所有的校验器都支持令牌 <code class="code">%value%</code>；这被你传递给<code class="code">isValid()</code>的值替换。其它的令牌按情况在每个校验类中被支持。例如，<code class="code">%max%</code>是一个被<code class="code">Zend_Validate_LessThan</code>支持的令牌。The <code class="code">getMessageVariables()</code>方法返回一个被校验器支持的令牌变量的数组。
        </p>
<p>
            第二个可选的参数是一个字符串，它识别是否校验失败消息模板被设置，当校验类定义了多于一个失败的原因的时候，这很有用。如果你忽略第二个参数，<code class="code">setMessage()</code>假定你指定的消息应该被用为在校验类中声明的第一个消息模板。许多校验类只定义了一个错误消息模板，所以不需要指定哪个消息模板需要修改。
        </p>
<p>
            </p>
<pre class="programlisting">&lt;?php
require_once 'Zend/Validate/StringLength.php';

$validator = new Zend_Validate_StringLength(8);

$validator-&gt;setMessage(
    'The string \'%value%\' is too short; it must be at least %min% characters',
    Zend_Validate_StringLength::TOO_SHORT);

if (!$validator-&gt;isValid('word')) {
    $messages = $validator-&gt;getMessages();
    echo $current($messages);

    // echoes "The string 'word' is too short; it must be at least 8 characters"
}

            </pre>
<p>
        </p>
<p>
            你可以用<code class="code">setMessages()</code>方法设置多个消息。它的参数是一个包含key/message对的数组。

            </p>
<pre class="programlisting">&lt;?php
require_once 'Zend/Validate/StringLength.php';

$validator = new Zend_Validate_StringLength(8, 12);

$validator-&gt;setMessages( array(
    Zend_Validate_StringLength::TOO_SHORT =&gt; 'The string \'%value%\' is too short',
    Zend_Validate_StringLength::TOO_LONG  =&gt; 'The string \'%value%\' is too long'
));

            </pre>
<p>

        </p>
<p>
            如果你的应用程序要求更灵活的校验失败报告，你可以访问和消息令牌同名的属性，这个消息令牌由给定的校验类支持。<code class="code">value</code>属性在校验器中总是有效；它是一个你指定作为<code class="code">isValid()</code>的参数的值。其他属性按照情况在每个校验类中被支持。

            </p>
<pre class="programlisting">&lt;?php
require_once 'Zend/Validate/StringLength.php';

$validator = new Zend_Validate_StringLength(8, 12);

if (!validator-&gt;isValid('word')) {
    echo 'Word failed: '
        . $validator-&gt;value
        . '; its length is not between '
        . $validator-&gt;min
        . ' and '
        . $validator-&gt;max
        . "\n";
}

            </pre>
<p>
        </p>
</div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.validate.introduction.static"></a>59.1.4.  使用静态 <code class="code">is()</code> 方法 </h3></div></div></div>
<p>
            如果加载一个校验类并创建这个校验器的实例不方便，你可以使用静态方法<code class="code">Zend_Validate::is()</code>作为可选的调用风格。第一个参数是一个数据输入值，你将把它传递给<code class="code">isValid()</code>方法。第二个参数是一个字符串，它和校验类的基本名字对应，和<code class="code">Zend_Validate</code>名字空间相关。<code class="code">is()</code>方法自动加载这个类，创建一个实例，并应用<code class="code">isValid()</code>方法到数据输入。

            </p>
<pre class="programlisting">&lt;?php
require_once 'Zend/Validate.php';

if (Zend_Validate::is($email, 'EmailAddress')) {
    // 是, email 有效
}

            </pre>
<p>
        </p>
<p>
           如果校验器需要，你也可以传递一个构造器参数的数组。

            </p>
<pre class="programlisting">&lt;?php
require_once 'Zend/Validate.php';

if (Zend_Validate::is($value, 'Between', array(1, 12))) {
    // Yes, $value is between 1 and 12
}

            </pre>
<p>
        </p>
<p>
            和<code class="code">isValid()</code>方法一样，<code class="code">is()</code>方法返回一个布尔值。当使用静态<code class="code">is()</code>方法时，校验失败消息不可用。
        </p>
<p>
            静态用法对于调用专用校验器可能方便，但如果为多重输入运行一个校验器，使用非静态用法更有效，创建一个校验器对象的实例并调用<code class="code">isValid()</code>方法。
        </p>
<p>
            并且，<code class="code">Zend_Filter_Input</code> 类允许你按需求实例化和运行多个过滤器和校验器类来处理输入数据集合，参见<a href="zend.filter.input.html" title="22.5. Zend_Filter_Input">第 22.5 节 “Zend_Filter_Input”</a>。

        </p>
</div>
</div>
</div>
<div class="navfooter"><table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="zend.uri.html">上一页</a> </td>
<td width="20%" align="center"> </td>
<td width="40%" align="right"> <a accesskey="n" href="zend.validate.set.html">下一页</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">第 58 章 Zend_Uri </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td>
<td width="40%" align="right" valign="top"> 59.2. 标准校验类</td>
</tr>
</table></div>
<div class="revinfo"></div>
</body>
</html>
