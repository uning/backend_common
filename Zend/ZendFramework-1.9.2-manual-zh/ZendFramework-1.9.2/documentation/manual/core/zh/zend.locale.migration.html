<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>31.6. Migrating from previous versions</title>
<link rel="stylesheet" href="dbstyle.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.72.0">
<link rel="start" href="index.html" title="Zend Framework手册 中文版">
<link rel="up" href="zend.locale.html" title="第 31 章 Zend_Locale">
<link rel="prev" href="zend.locale.appendix.html" title="31.5. Supported locales">
<link rel="next" href="zend.log.html" title="第 32 章 Zend_Log">
<link rel="chapter" href="introduction.html" title="第 1 章 Zend Framework简介">
<link rel="chapter" href="zend.acl.html" title="第 2 章 Zend_Acl">
<link rel="chapter" href="zend.amf.html" title="第 3 章 Zend_Amf">
<link rel="chapter" href="zend.application.html" title="第 4 章 Zend_Application">
<link rel="chapter" href="zend.auth.html" title="第 5 章 Zend_Auth">
<link rel="chapter" href="zend.cache.html" title="第 6 章 Zend_Cache">
<link rel="chapter" href="zend.captcha.html" title="第 7 章 Zend_Captcha">
<link rel="chapter" href="zend.codegenerator.html" title="第 8 章 Zend_CodeGenerator">
<link rel="chapter" href="zend.config.html" title="第 9 章 Zend_Config">
<link rel="chapter" href="zend.config.writer.html" title="第 10 章 Zend_Config_Writer">
<link rel="chapter" href="zend.console.getopt.html" title="第 11 章 Zend_Console_Getopt">
<link rel="chapter" href="zend.controller.html" title="第 12 章 Zend_Controller">
<link rel="chapter" href="zend.currency.html" title="第 13 章 Zend_Currency">
<link rel="chapter" href="zend.date.html" title="第 14 章 Zend_Date">
<link rel="chapter" href="zend.db.html" title="第 15 章 Zend_Db">
<link rel="chapter" href="zend.debug.html" title="第 16 章 Zend_Debug">
<link rel="chapter" href="zend.dojo.html" title="第 17 章 Zend_Dojo">
<link rel="chapter" href="zend.dom.html" title="第 18 章 Zend_Dom">
<link rel="chapter" href="zend.exception.html" title="第 19 章 Zend_Exception">
<link rel="chapter" href="zend.feed.html" title="第 20 章 Zend_Feed">
<link rel="chapter" href="zend.file.html" title="第 21 章 Zend_File">
<link rel="chapter" href="zend.filter.html" title="第 22 章 Zend_Filter">
<link rel="chapter" href="zend.form.html" title="第 23 章 Zend_Form">
<link rel="chapter" href="zend.gdata.html" title="第 24 章 Zend_Gdata">
<link rel="chapter" href="zend.http.html" title="第 25 章 Zend_Http">
<link rel="chapter" href="zend.infocard.html" title="第 26 章 Zend_InfoCard">
<link rel="chapter" href="zend.json.html" title="第 27 章 Zend_Json">
<link rel="chapter" href="zend.layout.html" title="第 28 章 Zend_Layout">
<link rel="chapter" href="zend.ldap.html" title="第 29 章 Zend_Ldap">
<link rel="chapter" href="zend.loader.html" title="第 30 章 Zend_Loader">
<link rel="chapter" href="zend.locale.html" title="第 31 章 Zend_Locale">
<link rel="chapter" href="zend.log.html" title="第 32 章 Zend_Log">
<link rel="chapter" href="zend.mail.html" title="第 33 章 Zend_Mail">
<link rel="chapter" href="zend.measure.html" title="第 34 章 Zend_Measure">
<link rel="chapter" href="zend.memory.html" title="第 35 章 Zend_Memory">
<link rel="chapter" href="zend.mime.html" title="第 36 章 Zend_Mime">
<link rel="chapter" href="zend.navigation.html" title="第 37 章 Zend_Navigation">
<link rel="chapter" href="zend.openid.html" title="第 38 章 Zend_OpenId">
<link rel="chapter" href="zend.paginator.html" title="第 39 章 Zend_Paginator">
<link rel="chapter" href="zend.pdf.html" title="第 40 章 Zend_Pdf">
<link rel="chapter" href="zend.progressbar.html" title="第 41 章 Zend_ProgressBar">
<link rel="chapter" href="zend.queue.html" title="第 42 章 Zend_Queue">
<link rel="chapter" href="zend.reflection.html" title="第 43 章 Zend_Reflection">
<link rel="chapter" href="zend.registry.html" title="第 44 章 Zend_Registry">
<link rel="chapter" href="zend.rest.html" title="第 45 章 Zend_Rest">
<link rel="chapter" href="zend.search.lucene.html" title="第 46 章 Zend_Search_Lucene">
<link rel="chapter" href="zend.server.html" title="第 47 章 Zend_Server">
<link rel="chapter" href="zend.service.html" title="第 48 章 Zend_Service">
<link rel="chapter" href="zend.session.html" title="第 49 章 Zend_Session">
<link rel="chapter" href="zend.soap.html" title="第 50 章 Zend_Soap">
<link rel="chapter" href="zend.tag.html" title="第 51 章 Zend_Tag">
<link rel="chapter" href="zend.test.html" title="第 52 章 Zend_Test">
<link rel="chapter" href="zend.text.html" title="第 53 章 Zend_Text">
<link rel="chapter" href="zend.timesync.html" title="第 54 章 Zend_TimeSync">
<link rel="chapter" href="zend.tool.framework.html" title="第 55 章 Zend_Tool_Framework">
<link rel="chapter" href="zend.tool.project.html" title="第 56 章 Zend_Tool_Project">
<link rel="chapter" href="zend.translate.html" title="第 57 章 Zend_Translate">
<link rel="chapter" href="zend.uri.html" title="第 58 章 Zend_Uri">
<link rel="chapter" href="zend.validate.html" title="第 59 章 Zend_Validate">
<link rel="chapter" href="zend.version.html" title="第 60 章 Zend_Version">
<link rel="chapter" href="zend.view.html" title="第 61 章 Zend_View">
<link rel="chapter" href="zend.wildfire.html" title="第 62 章 Zend_Wildfire">
<link rel="chapter" href="zend.xmlrpc.html" title="第 63 章 Zend_XmlRpc">
<link rel="chapter" href="zendx.console.process.unix.html" title="第 64 章 ZendX_Console_Process_Unix">
<link rel="chapter" href="zendx.jquery.html" title="第 65 章 ZendX_JQuery">
<link rel="appendix" href="requirements.html" title="附录 A. 系统需求">
<link rel="appendix" href="coding-standard.html" title="附录 B. Zend Framework 的 PHP 编码标准">
<link rel="appendix" href="doc-standard.html" title="附录 C. Zend Framework Documentation Standard">
<link rel="appendix" href="project-structure.html" title="附录 D. Recommended Project Structure for Zend Framework MVC Applications">
<link rel="appendix" href="performance.html" title="附录 E. Zend Framework Performance Guide">
<link rel="appendix" href="copyrights.html" title="附录 F. 版权信息">
<link rel="index" href="the.index.html" title="索引">
<link rel="subsection" href="zend.locale.migration.html#zend.locale.migration.fromoneeighttoonenine" title="31.6.1. Migrating from 1.8 to 1.9 or newer">
<link rel="subsection" href="zend.locale.migration.html#zend.locale.migration.fromoneseventooneeight" title="31.6.2. Migrating from 1.7 to 1.8 or newer">
<link rel="subsection" href="zend.locale.migration.html#zend.locale.migration.fromonesixtooneseven" title="31.6.3. Migrating from 1.6 to 1.7 or newer">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader"><table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">31.6. Migrating from previous versions</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="zend.locale.appendix.html">上一页</a> </td>
<th width="60%" align="center">第 31 章 Zend_Locale</th>
<td width="20%" align="right"> <a accesskey="n" href="zend.log.html">下一页</a>
</td>
</tr>
</table></div>
<div class="sect1" lang="zh-cn">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="zend.locale.migration"></a>31.6. Migrating from previous versions</h2></div></div></div>
<p>
        The <acronym class="acronym">API</acronym> of <code class="classname">Zend_Locale</code> has changed from time to time.
        If you started to use <code class="classname">Zend_Locale</code> and its subcomponents
        in earlier versions follow the guidelines below to migrate your scripts to
        use the new <acronym class="acronym">API</acronym>.
    </p>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.locale.migration.fromoneeighttoonenine"></a>31.6.1. Migrating from 1.8 to 1.9 or newer</h3></div></div></div>
<div class="sect3" lang="zh-cn">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.locale.migration.fromoneeighttoonenine.depreciated"></a>31.6.1.1. Depreciated methods</h4></div></div></div>
<p>
                Some specialized translation methods have been depreciated because they duplicate
                existing behaviour. Note that the old methods will still work, but a user notice is
                triggered which describes the new call. The methods will be erased with 2.0.
                See the following list for old and new method call.
            </p>
<div class="table">
<a name="zend.locale.migration.fromoneeighttoonenine.depreciated.table-1"></a><p class="title"><b>表 31.10. List of measurement types</b></p>
<div class="table-contents"><table summary="List of measurement types" border="1">
<colgroup>
<col>
<col>
</colgroup>
<thead><tr>
<th>Old call</th>
<th>New call</th>
</tr></thead>
<tbody>
<tr>
<td>getLanguageTranslationList($locale)</td>
<td>getTranslationList('language', $locale)</td>
</tr>
<tr>
<td>getScriptTranslationList($locale)</td>
<td>getTranslationList('script', $locale)</td>
</tr>
<tr>
<td>getCountryTranslationList($locale)</td>
<td>getTranslationList('territory', $locale, 2)</td>
</tr>
<tr>
<td>getTerritoryTranslationList($locale)</td>
<td>getTranslationList('territory', $locale, 1)</td>
</tr>
<tr>
<td>getLanguageTranslation($value, $locale)</td>
<td>getTranslation($value, 'language', $locale)</td>
</tr>
<tr>
<td>getScriptTranslation($value, $locale)</td>
<td>getTranslation($value, 'script', $locale)</td>
</tr>
<tr>
<td>getCountryTranslation($value, $locale)</td>
<td>getTranslation($value, 'country', $locale)</td>
</tr>
<tr>
<td>getTerritoryTranslation($value, $locale)</td>
<td>getTranslation($value, 'territory', $locale)</td>
</tr>
</tbody>
</table></div>
</div>
<br class="table-break">
</div>
</div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.locale.migration.fromoneseventooneeight"></a>31.6.2. Migrating from 1.7 to 1.8 or newer</h3></div></div></div>
<div class="sect3" lang="zh-cn">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.locale.migration.fromoneseventooneeight.defaultcaching"></a>31.6.2.1. Default caching</h4></div></div></div>
<p>
                As with Zend Framework 1.8 a default caching was added. The reason behind this
                change was, that most users had performance problems but did not add caching at
                all. As the I18n core is a bottleneck when no caching is used we decided to add
                a default caching when no cache has been set to <code class="classname">Zend_Locale</code>.
            </p>
<p>
                Sometimes it is still wanted to prevent caching at all even if this decreases
                performance. To do so you can simply disable caching by using the
                <code class="methodname">disableCache()</code> method.
            </p>
<div class="example">
<a name="zend.locale.migration.fromoneseventooneeight.example"></a><p class="title"><b>例 31.50. Disabling default caching</b></p>
<div class="example-contents"><pre class="programlisting">
Zend_Locale::disableCache(true);
</pre></div>
</div>
<br class="example-break">
</div>
</div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.locale.migration.fromonesixtooneseven"></a>31.6.3. Migrating from 1.6 to 1.7 or newer</h3></div></div></div>
<div class="sect3" lang="zh-cn">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.locale.migration.fromonesixtooneseven.islocale"></a>31.6.3.1. Changes when using isLocale()</h4></div></div></div>
<p>
                According to the coding standards isLocale() had to be changed to return
                a boolean. In previous releases a string was returned on success. For
                release 1.7 a compatibility mode has been added which allows to use the
                old behaviour of a returned string, but it triggers a user warning to
                mention you to change to the new behaviour. The rerouting which the old
                behaviour of isLocale() could have done is no longer neccessary as all
                I18N will now process a rerouting themself.
            </p>
<p>
                To migrate your scripts to the new <acronym class="acronym">API</acronym>, simply use the method as shown below.
            </p>
<div class="example">
<a name="zend.locale.migration.fromonesixtooneseven.example"></a><p class="title"><b>例 31.51. How to change isLocale() from 1.6 to 1.7</b></p>
<div class="example-contents">
<pre class="programlisting">
// Example for 1.6
if ($locale = Zend_Locale::isLocale($locale)) {
    // do something
}

// Same example for 1.7

// You should change the compatiblity mode to prevent user warnings
// But you can do this in your bootstrap
Zend_Locale::$compatibilityMode = false;

if (Zend_Locale::isLocale($locale)) {
}
</pre>
<p>
                    Note that you can use the second parameter to see if the locale is correct without
                    processing a rerouting.
                </p>
<pre class="programlisting">
// Example for 1.6
if ($locale = Zend_Locale::isLocale($locale, false)) {
    // do something
}

// Same example for 1.7

// You should change the compatiblity mode to prevent user warnings
// But you can do this in your bootstrap
Zend_Locale::$compatibilityMode = false;

if (Zend_Locale::isLocale($locale, false)) {
    if (Zend_Locale::isLocale($locale, true)) {
        // no locale at all
    }

    // original string is no locale but can be rerouted
}
</pre>
</div>
</div>
<br class="example-break">
</div>
<div class="sect3" lang="zh-cn">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.locale.migration.fromonesixtooneseven.getdefault"></a>31.6.3.2. Changes when using getDefault()</h4></div></div></div>
<p>
                The meaning of the getDefault() method has been change due to the fact that we
                integrated a framework locale which can be set with setDefault(). It does no
                longer return the locale chain but only the set framework locale.
            </p>
<p>
                To migrate your scripts to the new <acronym class="acronym">API</acronym>, simply use the method as shown below.
            </p>
<div class="example">
<a name="zend.locale.migration.fromonesixtooneseven.getdefault.example"></a><p class="title"><b>例 31.52. How to change getDefault() from 1.6 to 1.7</b></p>
<div class="example-contents">
<pre class="programlisting">
// Example for 1.6
$locales = $locale-&gt;getDefault(Zend_Locale::BROWSER);

// Same example for 1.7

// You should change the compatiblity mode to prevent user warnings
// But you can do this in your bootstrap
Zend_Locale::$compatibilityMode = false;

$locale = Zend_Locale::getOrder(Zend_Locale::BROWSER);
</pre>
<p>
                    Note that the second parameter of the old getDefault() implementation is not
                    available anymore, but the returned values are the same.
                </p>
</div>
</div>
<br class="example-break"><div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[注意]" src="images/note.png"></td>
<th align="left">注意</th>
</tr>
<tr><td align="left" valign="top"><p>
                    Per default the old behaviour is still active, but throws a user warning.
                    When you have changed your code to the new behaviour you should also change
                    the compatibility mode to false so that no warning is thrown anymore.
                </p></td></tr>
</table></div>
</div>
</div>
</div>
<div class="navfooter"><table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="zend.locale.appendix.html">上一页</a> </td>
<td width="20%" align="center"><a accesskey="u" href="zend.locale.html">上一级</a></td>
<td width="40%" align="right"> <a accesskey="n" href="zend.log.html">下一页</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">31.5. Supported locales </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td>
<td width="40%" align="right" valign="top"> 第 32 章 Zend_Log</td>
</tr>
</table></div>
<div class="revinfo"></div>
</body>
</html>
