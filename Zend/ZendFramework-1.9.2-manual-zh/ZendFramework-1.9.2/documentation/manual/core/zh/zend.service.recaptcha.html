<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>48.21. Zend_Service_ReCaptcha</title>
<link rel="stylesheet" href="dbstyle.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.72.0">
<link rel="start" href="index.html" title="Zend Framework手册 中文版">
<link rel="up" href="zend.service.html" title="第 48 章 Zend_Service">
<link rel="prev" href="zend.service.nirvanix.html" title="48.20. Zend_Service_Nirvanix">
<link rel="next" href="zend.service.simpy.html" title="48.22. Zend_Service_Simpy">
<link rel="chapter" href="introduction.html" title="第 1 章 Zend Framework简介">
<link rel="chapter" href="zend.acl.html" title="第 2 章 Zend_Acl">
<link rel="chapter" href="zend.amf.html" title="第 3 章 Zend_Amf">
<link rel="chapter" href="zend.application.html" title="第 4 章 Zend_Application">
<link rel="chapter" href="zend.auth.html" title="第 5 章 Zend_Auth">
<link rel="chapter" href="zend.cache.html" title="第 6 章 Zend_Cache">
<link rel="chapter" href="zend.captcha.html" title="第 7 章 Zend_Captcha">
<link rel="chapter" href="zend.codegenerator.html" title="第 8 章 Zend_CodeGenerator">
<link rel="chapter" href="zend.config.html" title="第 9 章 Zend_Config">
<link rel="chapter" href="zend.config.writer.html" title="第 10 章 Zend_Config_Writer">
<link rel="chapter" href="zend.console.getopt.html" title="第 11 章 Zend_Console_Getopt">
<link rel="chapter" href="zend.controller.html" title="第 12 章 Zend_Controller">
<link rel="chapter" href="zend.currency.html" title="第 13 章 Zend_Currency">
<link rel="chapter" href="zend.date.html" title="第 14 章 Zend_Date">
<link rel="chapter" href="zend.db.html" title="第 15 章 Zend_Db">
<link rel="chapter" href="zend.debug.html" title="第 16 章 Zend_Debug">
<link rel="chapter" href="zend.dojo.html" title="第 17 章 Zend_Dojo">
<link rel="chapter" href="zend.dom.html" title="第 18 章 Zend_Dom">
<link rel="chapter" href="zend.exception.html" title="第 19 章 Zend_Exception">
<link rel="chapter" href="zend.feed.html" title="第 20 章 Zend_Feed">
<link rel="chapter" href="zend.file.html" title="第 21 章 Zend_File">
<link rel="chapter" href="zend.filter.html" title="第 22 章 Zend_Filter">
<link rel="chapter" href="zend.form.html" title="第 23 章 Zend_Form">
<link rel="chapter" href="zend.gdata.html" title="第 24 章 Zend_Gdata">
<link rel="chapter" href="zend.http.html" title="第 25 章 Zend_Http">
<link rel="chapter" href="zend.infocard.html" title="第 26 章 Zend_InfoCard">
<link rel="chapter" href="zend.json.html" title="第 27 章 Zend_Json">
<link rel="chapter" href="zend.layout.html" title="第 28 章 Zend_Layout">
<link rel="chapter" href="zend.ldap.html" title="第 29 章 Zend_Ldap">
<link rel="chapter" href="zend.loader.html" title="第 30 章 Zend_Loader">
<link rel="chapter" href="zend.locale.html" title="第 31 章 Zend_Locale">
<link rel="chapter" href="zend.log.html" title="第 32 章 Zend_Log">
<link rel="chapter" href="zend.mail.html" title="第 33 章 Zend_Mail">
<link rel="chapter" href="zend.measure.html" title="第 34 章 Zend_Measure">
<link rel="chapter" href="zend.memory.html" title="第 35 章 Zend_Memory">
<link rel="chapter" href="zend.mime.html" title="第 36 章 Zend_Mime">
<link rel="chapter" href="zend.navigation.html" title="第 37 章 Zend_Navigation">
<link rel="chapter" href="zend.openid.html" title="第 38 章 Zend_OpenId">
<link rel="chapter" href="zend.paginator.html" title="第 39 章 Zend_Paginator">
<link rel="chapter" href="zend.pdf.html" title="第 40 章 Zend_Pdf">
<link rel="chapter" href="zend.progressbar.html" title="第 41 章 Zend_ProgressBar">
<link rel="chapter" href="zend.queue.html" title="第 42 章 Zend_Queue">
<link rel="chapter" href="zend.reflection.html" title="第 43 章 Zend_Reflection">
<link rel="chapter" href="zend.registry.html" title="第 44 章 Zend_Registry">
<link rel="chapter" href="zend.rest.html" title="第 45 章 Zend_Rest">
<link rel="chapter" href="zend.search.lucene.html" title="第 46 章 Zend_Search_Lucene">
<link rel="chapter" href="zend.server.html" title="第 47 章 Zend_Server">
<link rel="chapter" href="zend.service.html" title="第 48 章 Zend_Service">
<link rel="chapter" href="zend.session.html" title="第 49 章 Zend_Session">
<link rel="chapter" href="zend.soap.html" title="第 50 章 Zend_Soap">
<link rel="chapter" href="zend.tag.html" title="第 51 章 Zend_Tag">
<link rel="chapter" href="zend.test.html" title="第 52 章 Zend_Test">
<link rel="chapter" href="zend.text.html" title="第 53 章 Zend_Text">
<link rel="chapter" href="zend.timesync.html" title="第 54 章 Zend_TimeSync">
<link rel="chapter" href="zend.tool.framework.html" title="第 55 章 Zend_Tool_Framework">
<link rel="chapter" href="zend.tool.project.html" title="第 56 章 Zend_Tool_Project">
<link rel="chapter" href="zend.translate.html" title="第 57 章 Zend_Translate">
<link rel="chapter" href="zend.uri.html" title="第 58 章 Zend_Uri">
<link rel="chapter" href="zend.validate.html" title="第 59 章 Zend_Validate">
<link rel="chapter" href="zend.version.html" title="第 60 章 Zend_Version">
<link rel="chapter" href="zend.view.html" title="第 61 章 Zend_View">
<link rel="chapter" href="zend.wildfire.html" title="第 62 章 Zend_Wildfire">
<link rel="chapter" href="zend.xmlrpc.html" title="第 63 章 Zend_XmlRpc">
<link rel="chapter" href="zendx.console.process.unix.html" title="第 64 章 ZendX_Console_Process_Unix">
<link rel="chapter" href="zendx.jquery.html" title="第 65 章 ZendX_JQuery">
<link rel="appendix" href="requirements.html" title="附录 A. 系统需求">
<link rel="appendix" href="coding-standard.html" title="附录 B. Zend Framework 的 PHP 编码标准">
<link rel="appendix" href="doc-standard.html" title="附录 C. Zend Framework Documentation Standard">
<link rel="appendix" href="project-structure.html" title="附录 D. Recommended Project Structure for Zend Framework MVC Applications">
<link rel="appendix" href="performance.html" title="附录 E. Zend Framework Performance Guide">
<link rel="appendix" href="copyrights.html" title="附录 F. 版权信息">
<link rel="index" href="the.index.html" title="索引">
<link rel="subsection" href="zend.service.recaptcha.html#zend.service.recaptcha.introduction" title="48.21.1. Introduction">
<link rel="subsection" href="zend.service.recaptcha.html#zend.service.recaptcha.simplestuse" title="48.21.2. Simplest use">
<link rel="subsection" href="zend.service.recaptcha.html#zend.service.recaptcha.mailhide" title="48.21.3. Hiding email addresses">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader"><table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">48.21. Zend_Service_ReCaptcha</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="zend.service.nirvanix.html">上一页</a> </td>
<th width="60%" align="center">第 48 章 Zend_Service</th>
<td width="20%" align="right"> <a accesskey="n" href="zend.service.simpy.html">下一页</a>
</td>
</tr>
</table></div>
<div class="sect1" lang="zh-cn">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="zend.service.recaptcha"></a>48.21. Zend_Service_ReCaptcha</h2></div></div></div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.service.recaptcha.introduction"></a>48.21.1. Introduction</h3></div></div></div>
<p>
            <code class="classname">Zend_Service_ReCaptcha</code> provides a client for the <a href="http://recaptcha.net/" target="_top">reCAPTCHA Web Service</a>.
            Per the reCAPTCHA site, "reCAPTCHA is a free CAPTCHA service that
            helps to digitize books." Each reCAPTCHA requires the user to input
            two words, the first of which is the actual captcha, and the second
            of which is a word from some scanned text that Optical Character
            Recognition (OCR) software has been unable to identify.
            The assumption is that if a user correctly provides the first
            word, the second is likely correctly entered as well, and can be
            used to improve OCR software for digitizing books.
        </p>
<p>
            In order to use the reCAPTCHA service, you will need to <a href="http://recaptcha.net/whyrecaptcha.html" target="_top">sign up for an
                account</a> and register one or more domains with the
            service in order to generate public and private keys.
        </p>
</div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.service.recaptcha.simplestuse"></a>48.21.2. Simplest use</h3></div></div></div>
<p>
            Instantiate a <code class="classname">Zend_Service_ReCaptcha</code> object, passing it
            your public and private keys:
        </p>
<div class="example">
<a name="zend.service.recaptcha.example-1"></a><p class="title"><b>例 48.95. Creating an instance of the ReCaptcha service</b></p>
<div class="example-contents"><pre class="programlisting">
$recaptcha = new Zend_Service_ReCaptcha($pubKey, $privKey);
</pre></div>
</div>
<br class="example-break"><p>
            To render the reCAPTCHA, simply call the <code class="methodname">getHTML()</code>
            method:
        </p>
<div class="example">
<a name="zend.service.recaptcha.example-2"></a><p class="title"><b>例 48.96. Displaying the ReCaptcha</b></p>
<div class="example-contents"><pre class="programlisting">
echo $recaptcha-&gt;getHTML();
</pre></div>
</div>
<br class="example-break"><p>
            When the form is submitted, you should receive two fields,
            'recaptcha_challenge_field' and 'recaptcha_response_field'. Pass
            these to the ReCaptcha object's <code class="methodname">verify()</code> method:
        </p>
<div class="example">
<a name="zend.service.recaptcha.example-3"></a><p class="title"><b>例 48.97. Verifying the form fields</b></p>
<div class="example-contents"><pre class="programlisting">
$result = $recaptcha-&gt;verify(
    $_POST['recaptcha_challenge_field'],
    $_POST['recaptcha_response_field']
);
</pre></div>
</div>
<br class="example-break"><p>
            Once you have the result, test against it to see if it is valid. The
            result is a <code class="classname">Zend_Service_ReCaptcha_Response</code> object,
            which provides an <code class="methodname">isValid()</code> method.
        </p>
<div class="example">
<a name="zend.service.recaptcha.example-4"></a><p class="title"><b>例 48.98. Validating the ReCaptcha</b></p>
<div class="example-contents"><pre class="programlisting">
if (!$result-&gt;isValid()) {
    // Failed validation
}
</pre></div>
</div>
<br class="example-break"><p>
            Even simpler is to use <a href="zend.captcha.adapters.html#zend.captcha.adapters.recaptcha" title="7.3.5. Zend_Captcha_ReCaptcha">the ReCaptcha</a>
            <code class="classname">Zend_Captcha</code> adapter, or to use that adapter as a
            backend for the <a href="">Captcha form
                element</a>. In each case, the details of rendering and
            validating the reCAPTCHA are automated for you.
        </p>
</div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.service.recaptcha.mailhide"></a>48.21.3. Hiding email addresses</h3></div></div></div>
<p>
            <code class="classname">Zend_Service_ReCaptcha_MailHide</code> can be used to hide email 
            addresses. It will replace a part of an email address with a link that opens a popup 
            window with a ReCaptcha challenge. Solving the challenge will reveal the complete 
            email address. 
        </p>
<p>
            In order to use this component you will need 
            <a href="http://recaptcha.net/whyrecaptcha.html" target="_top">an account</a>, and generate 
            public and private keys for the mailhide API.
        </p>
<div class="example">
<a name="zend.service.recaptcha.mailhide.example-1"></a><p class="title"><b>例 48.99. Using the mail hide component</b></p>
<div class="example-contents"><pre class="programlisting">
// The mail address we want to hide
$mail = 'mail@example.com';

// Create an instance of the mailhide component, passing it your public and private keys as well as 
// the mail address you want to hide
$mailHide = new Zend_Service_ReCaptcha_Mailhide();
$mailHide-&gt;setPublicKey($pubKey);
$mailHide-&gt;setPrivateKey($privKey);
$mailHide-&gt;setEmail($mail);

// Display it
print($mailHide);
</pre></div>
</div>
<br class="example-break"><p>
            The example above will display "m...@example.com" where "..." has a link that opens up 
            a popup windows with a ReCaptcha challenge.
        </p>
<p>
            The public key, private key and the email address can also be specified in the 
            constructor of the class. A fourth argument also exists that enables you to set some
            options for the component. The available options are listed in the following table:
            </p>
<div class="table">
<a name="zend.service.recaptcha.mailhide.options.table"></a><p class="title"><b>表 48.19. Zend_Service_ReCaptcha_MailHide options</b></p>
<div class="table-contents"><table summary="Zend_Service_ReCaptcha_MailHide options" border="1">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead><tr>
<th>Option</th>
<th>Description</th>
<th>Expected Values</th>
<th>Default Value</th>
</tr></thead>
<tbody>
<tr>
<td>linkTitle</td>
<td>The title attribute of the link</td>
<td>string</td>
<td>'Reveal this e-mail address'</td>
</tr>
<tr>
<td>linkHiddenText</td>
<td>The text that includes the popup link</td>
<td>string</td>
<td>'...'</td>
</tr>
<tr>
<td>popupWidth</td>
<td>The width of the popup window</td>
<td>int</td>
<td>500</td>
</tr>
<tr>
<td>popupHeight</td>
<td>The height of the popup window</td>
<td>int</td>
<td>300</td>
</tr>
</tbody>
</table></div>
</div>
<p><br class="table-break">
        </p>
<p>
            The configuration options can be set by sending it as the fourth argument to the 
            constructor or by calling the <code class="methodname">setOptions($options)</code> which takes 
            an associative array or an instance of <a href="zend.config.html" title="第 9 章 Zend_Config">Zend_Config</a>.
        </p>
<div class="example">
<a name="zend.service.recaptcha.mailhide.example-2"></a><p class="title"><b>例 48.100. Generating many hidden email addresses</b></p>
<div class="example-contents"><pre class="programlisting">
// Create an instance of the mailhide component, passing it your public and private keys as well as 
// well the mail address you want to hide
$mailHide = new Zend_Service_ReCaptcha_Mailhide();
$mailHide-&gt;setPublicKey($pubKey);
$mailHide-&gt;setPrivateKey($privKey);
$mailHide-&gt;setOptions(array(
    'linkTitle' =&gt; 'Click me',
    'linkHiddenText' =&gt; '+++++',
));

// The addresses we want to hide
$mailAddresses = array(
    'mail@example.com',
    'johndoe@example.com',
    'janedoe@example.com',
);

foreach ($mailAddresses as $mail) {
    $mailHide-&gt;setEmail($mail);
    print($mailHide);
}
</pre></div>
</div>
<br class="example-break">
</div>
</div>
<div class="navfooter"><table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="zend.service.nirvanix.html">上一页</a> </td>
<td width="20%" align="center"><a accesskey="u" href="zend.service.html">上一级</a></td>
<td width="40%" align="right"> <a accesskey="n" href="zend.service.simpy.html">下一页</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">48.20. Zend_Service_Nirvanix </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td>
<td width="40%" align="right" valign="top"> 48.22. Zend_Service_Simpy</td>
</tr>
</table></div>
<div class="revinfo"></div>
</body>
</html>
