<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>4.2. Zend_Application Quick Start</title>
<link rel="stylesheet" href="dbstyle.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.72.0">
<link rel="start" href="index.html" title="Zend Framework手册 中文版">
<link rel="up" href="zend.application.html" title="第 4 章 Zend_Application">
<link rel="prev" href="zend.application.html" title="第 4 章 Zend_Application">
<link rel="next" href="zend.application.theory-of-operation.html" title="4.3. Theory of Operation">
<link rel="chapter" href="introduction.html" title="第 1 章 Zend Framework简介">
<link rel="chapter" href="zend.acl.html" title="第 2 章 Zend_Acl">
<link rel="chapter" href="zend.amf.html" title="第 3 章 Zend_Amf">
<link rel="chapter" href="zend.application.html" title="第 4 章 Zend_Application">
<link rel="chapter" href="zend.auth.html" title="第 5 章 Zend_Auth">
<link rel="chapter" href="zend.cache.html" title="第 6 章 Zend_Cache">
<link rel="chapter" href="zend.captcha.html" title="第 7 章 Zend_Captcha">
<link rel="chapter" href="zend.codegenerator.html" title="第 8 章 Zend_CodeGenerator">
<link rel="chapter" href="zend.config.html" title="第 9 章 Zend_Config">
<link rel="chapter" href="zend.config.writer.html" title="第 10 章 Zend_Config_Writer">
<link rel="chapter" href="zend.console.getopt.html" title="第 11 章 Zend_Console_Getopt">
<link rel="chapter" href="zend.controller.html" title="第 12 章 Zend_Controller">
<link rel="chapter" href="zend.currency.html" title="第 13 章 Zend_Currency">
<link rel="chapter" href="zend.date.html" title="第 14 章 Zend_Date">
<link rel="chapter" href="zend.db.html" title="第 15 章 Zend_Db">
<link rel="chapter" href="zend.debug.html" title="第 16 章 Zend_Debug">
<link rel="chapter" href="zend.dojo.html" title="第 17 章 Zend_Dojo">
<link rel="chapter" href="zend.dom.html" title="第 18 章 Zend_Dom">
<link rel="chapter" href="zend.exception.html" title="第 19 章 Zend_Exception">
<link rel="chapter" href="zend.feed.html" title="第 20 章 Zend_Feed">
<link rel="chapter" href="zend.file.html" title="第 21 章 Zend_File">
<link rel="chapter" href="zend.filter.html" title="第 22 章 Zend_Filter">
<link rel="chapter" href="zend.form.html" title="第 23 章 Zend_Form">
<link rel="chapter" href="zend.gdata.html" title="第 24 章 Zend_Gdata">
<link rel="chapter" href="zend.http.html" title="第 25 章 Zend_Http">
<link rel="chapter" href="zend.infocard.html" title="第 26 章 Zend_InfoCard">
<link rel="chapter" href="zend.json.html" title="第 27 章 Zend_Json">
<link rel="chapter" href="zend.layout.html" title="第 28 章 Zend_Layout">
<link rel="chapter" href="zend.ldap.html" title="第 29 章 Zend_Ldap">
<link rel="chapter" href="zend.loader.html" title="第 30 章 Zend_Loader">
<link rel="chapter" href="zend.locale.html" title="第 31 章 Zend_Locale">
<link rel="chapter" href="zend.log.html" title="第 32 章 Zend_Log">
<link rel="chapter" href="zend.mail.html" title="第 33 章 Zend_Mail">
<link rel="chapter" href="zend.measure.html" title="第 34 章 Zend_Measure">
<link rel="chapter" href="zend.memory.html" title="第 35 章 Zend_Memory">
<link rel="chapter" href="zend.mime.html" title="第 36 章 Zend_Mime">
<link rel="chapter" href="zend.navigation.html" title="第 37 章 Zend_Navigation">
<link rel="chapter" href="zend.openid.html" title="第 38 章 Zend_OpenId">
<link rel="chapter" href="zend.paginator.html" title="第 39 章 Zend_Paginator">
<link rel="chapter" href="zend.pdf.html" title="第 40 章 Zend_Pdf">
<link rel="chapter" href="zend.progressbar.html" title="第 41 章 Zend_ProgressBar">
<link rel="chapter" href="zend.queue.html" title="第 42 章 Zend_Queue">
<link rel="chapter" href="zend.reflection.html" title="第 43 章 Zend_Reflection">
<link rel="chapter" href="zend.registry.html" title="第 44 章 Zend_Registry">
<link rel="chapter" href="zend.rest.html" title="第 45 章 Zend_Rest">
<link rel="chapter" href="zend.search.lucene.html" title="第 46 章 Zend_Search_Lucene">
<link rel="chapter" href="zend.server.html" title="第 47 章 Zend_Server">
<link rel="chapter" href="zend.service.html" title="第 48 章 Zend_Service">
<link rel="chapter" href="zend.session.html" title="第 49 章 Zend_Session">
<link rel="chapter" href="zend.soap.html" title="第 50 章 Zend_Soap">
<link rel="chapter" href="zend.tag.html" title="第 51 章 Zend_Tag">
<link rel="chapter" href="zend.test.html" title="第 52 章 Zend_Test">
<link rel="chapter" href="zend.text.html" title="第 53 章 Zend_Text">
<link rel="chapter" href="zend.timesync.html" title="第 54 章 Zend_TimeSync">
<link rel="chapter" href="zend.tool.framework.html" title="第 55 章 Zend_Tool_Framework">
<link rel="chapter" href="zend.tool.project.html" title="第 56 章 Zend_Tool_Project">
<link rel="chapter" href="zend.translate.html" title="第 57 章 Zend_Translate">
<link rel="chapter" href="zend.uri.html" title="第 58 章 Zend_Uri">
<link rel="chapter" href="zend.validate.html" title="第 59 章 Zend_Validate">
<link rel="chapter" href="zend.version.html" title="第 60 章 Zend_Version">
<link rel="chapter" href="zend.view.html" title="第 61 章 Zend_View">
<link rel="chapter" href="zend.wildfire.html" title="第 62 章 Zend_Wildfire">
<link rel="chapter" href="zend.xmlrpc.html" title="第 63 章 Zend_XmlRpc">
<link rel="chapter" href="zendx.console.process.unix.html" title="第 64 章 ZendX_Console_Process_Unix">
<link rel="chapter" href="zendx.jquery.html" title="第 65 章 ZendX_JQuery">
<link rel="appendix" href="requirements.html" title="附录 A. 系统需求">
<link rel="appendix" href="coding-standard.html" title="附录 B. Zend Framework 的 PHP 编码标准">
<link rel="appendix" href="doc-standard.html" title="附录 C. Zend Framework Documentation Standard">
<link rel="appendix" href="project-structure.html" title="附录 D. Recommended Project Structure for Zend Framework MVC Applications">
<link rel="appendix" href="performance.html" title="附录 E. Zend Framework Performance Guide">
<link rel="appendix" href="copyrights.html" title="附录 F. 版权信息">
<link rel="index" href="the.index.html" title="索引">
<link rel="subsection" href="zend.application.quick-start.html#zend.application.quick-start.zend-tool" title="4.2.1. Using Zend_Tool">
<link rel="subsection" href="zend.application.quick-start.html#zend.application.quick-start.manual" title="4.2.2. Adding Zend_Application to your application">
<link rel="subsection" href="zend.application.quick-start.html#zend.application.quick-start.resources" title="4.2.3. Adding and creating resources">
<link rel="subsection" href="zend.application.quick-start.html#zend.application.quick-start.next-steps" title="4.2.4. Next steps with Zend_Application">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader"><table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">4.2. Zend_Application Quick Start</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="zend.application.html">上一页</a> </td>
<th width="60%" align="center">第 4 章 Zend_Application</th>
<td width="20%" align="right"> <a accesskey="n" href="zend.application.theory-of-operation.html">下一页</a>
</td>
</tr>
</table></div>
<div class="sect1" lang="zh-cn">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="zend.application.quick-start"></a>4.2. Zend_Application Quick Start</h2></div></div></div>
<p>
        There are two paths to getting started with
        <code class="classname">Zend_Application</code>, and they depend on how you start your
        project. In each case, you always start with creating a
        <code class="classname">Bootstrap</code> class, and a related configuration file.
    </p>
<p>
        If you plan on using <code class="classname">Zend_Tool</code> to create your project,
        continue reading below. If you will be adding
        <code class="classname">Zend_Application</code> to an existing project, you'll want to
        <a href="zend.application.quick-start.html#zend.application.quick-start.manual" title="4.2.2. Adding Zend_Application to your application">skip ahead</a>.
    </p>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.application.quick-start.zend-tool"></a>4.2.1. Using Zend_Tool</h3></div></div></div>
<p>
            The quickest way to start using <code class="classname">Zend_Application</code> is to use
            <code class="classname">Zend_Tool</code> to generate your project. This will also create
            your <code class="classname">Bootstrap</code> class and file.
        </p>
<p>
            To create a project, execute the <span><strong class="command">zf</strong></span> command (on *nix systems):
        </p>
<pre class="programlisting">
% zf create project newproject
</pre>
<p>
            Or the Windows <code class="filename">zf.bat</code> command:
        </p>
<pre class="programlisting">
C:&gt; zf.bat create project newproject
</pre>
<p>
            Both will create a project structure that looks like the following:
        </p>
<pre class="programlisting">
newproject
|-- application
|   |-- Bootstrap.php
|   |-- configs
|   |   `-- application.ini
|   |-- controllers
|   |   |-- ErrorController.php
|   |   `-- IndexController.php
|   |-- models
|   `-- views
|       |-- helpers
|       `-- scripts
|           |-- error
|           |   `-- error.phtml
|           `-- index
|               `-- index.phtml
|-- library
|-- public
|   `-- index.php
`-- tests
    |-- application
    |   `-- bootstrap.php
    |-- library
    |   `-- bootstrap.php
    `-- phpunit.xml
</pre>
<p>
            In the above diagram, your bootstrap is in
            <code class="filename">newproject/application/Bootstrap.php</code>, and looks like
            the following at first:
        </p>
<pre class="programlisting">
class Bootstrap extends Zend_Application_Bootstrap_Bootstrap
{
}
</pre>
<p>
            You'll also note that a configuration file,
            <code class="filename">newproject/application/configs/application.ini</code>, is
            created. It has the following contents:
        </p>
<pre class="programlisting">
[production]
phpSettings.display_startup_errors = 0
phpSettings.display_errors = 0
includePaths.library = APPLICATION_PATH "/../library"
bootstrap.path = APPLICATION_PATH "/Bootstrap.php"
bootstrap.class = "Bootstrap"
resources.frontController.controllerDirectory = APPLICATION_PATH "/controllers"

[staging : production]

[testing : production]
phpSettings.display_startup_errors = 1
phpSettings.display_errors = 1

[development : production]
phpSettings.display_startup_errors = 1
phpSettings.display_errors = 1
</pre>
<p>
            All settings in this configuration file are for use with
            <code class="classname">Zend_Application</code> and your bootstrap.
        </p>
<p>
            Another file of interest is the
            <code class="filename">newproject/public/index.php</code> file, which invokes
            <code class="classname">Zend_Application</code> and dispatches it.
        </p>
<pre class="programlisting">
// Define path to application directory
defined('APPLICATION_PATH')
    || define('APPLICATION_PATH',
              realpath(dirname(__FILE__) . '/../application'));

// Define application environment
defined('APPLICATION_ENV')
    || define('APPLICATION_ENV',
              (getenv('APPLICATION_ENV') ? getenv('APPLICATION_ENV')
                                         : 'production'));

/** Zend_Application */
require_once 'Zend/Application.php';

// Create application, bootstrap, and run
$application = new Zend_Application(
    APPLICATION_ENV,
    APPLICATION_PATH . '/configs/application.ini'
);
$application-&gt;bootstrap()
            -&gt;run();
</pre>
<p>
            To continue the quick start, please <a href="zend.application.quick-start.html#zend.application.quick-start.resources" title="4.2.3. Adding and creating resources">skip to the
            Resources section</a>.
        </p>
</div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.application.quick-start.manual"></a>4.2.2. Adding Zend_Application to your application</h3></div></div></div>
<p>
            The basics of <code class="classname">Zend_Application</code> are fairly simple:
        </p>
<div class="itemizedlist"><ul type="disc">
<li><p>
                Create an <code class="filename">application/Bootstrap.php</code> file, with the
                class <code class="classname">Bootstrap</code>.
            </p></li>
<li><p>
                Create an <code class="filename">application/configs/application.ini</code>
                configuration file with the base configuration necessary for
                <code class="classname">Zend_Application</code>.
            </p></li>
<li><p>
                Modify your <code class="filename">public/index.php</code> to utilize
                <code class="classname">Zend_Application</code>.
            </p></li>
</ul></div>
<p>
            First, create your <code class="classname">Bootstrap</code> class. Create a file,
            <code class="filename">application/Bootstrap.php</code>, with the following contents:
        </p>
<pre class="programlisting">
class Bootstrap extends Zend_Application_Bootstrap_Bootstrap
{
}
</pre>
<p>
            Now, create your configuration. For this tutorial, we will use an
            <acronym class="acronym">INI</acronym> style configuration; you may, of course, use an
            <acronym class="acronym">XML</acronym> or <acronym class="acronym">PHP</acronym> configuration file as well. Create
            the file <code class="filename">application/configs/application.ini</code>, and provide the
            following contents:
        </p>
<pre class="programlisting">
[production]
phpSettings.display_startup_errors = 0
phpSettings.display_errors = 0
includePaths.library = APPLICATION_PATH "/../library"
bootstrap.path = APPLICATION_PATH "/Bootstrap.php"
bootstrap.class = "Bootstrap"
resources.frontController.controllerDirectory = APPLICATION_PATH "/controllers"

[staging : production]

[testing : production]
phpSettings.display_startup_errors = 1
phpSettings.display_errors = 1

[development : production]
phpSettings.display_startup_errors = 1
phpSettings.display_errors = 1
</pre>
<p>
            Now, let's modify your gateway script,
            <code class="filename">public/index.php</code>. If the file does not exist, create
            it; otherwise, replace it with the following contents:
        </p>
<pre class="programlisting">
// Define path to application directory
defined('APPLICATION_PATH')
    || define('APPLICATION_PATH',
              realpath(dirname(__FILE__) . '/../application'));

// Define application environment
defined('APPLICATION_ENV')
    || define('APPLICATION_ENV',
              (getenv('APPLICATION_ENV') ? getenv('APPLICATION_ENV')
                                         : 'production'));

// Typically, you will also want to add your library/ directory
// to the include_path, particularly if it contains your ZF installed
set_include_path(implode(PATH_SEPARATOR, array(
    dirname(dirname(__FILE__)) . '/library',
    get_include_path(),
)));

/** Zend_Application */
require_once 'Zend/Application.php';

// Create application, bootstrap, and run
$application = new Zend_Application(
    APPLICATION_ENV,
    APPLICATION_PATH . '/configs/application.ini'
);
$application-&gt;bootstrap()
            -&gt;run();
</pre>
<p>
            You may note that the application environment constant value looks
            for an environment variable "APPLICATION_ENV". We recommend setting
            this in your web server environment. In Apache, you can set this
            either in your vhost definition, or in your <code class="filename">.htaccess</code>
            file. We recommend the following contents for your
            <code class="filename">public/.htaccess</code> file:
        </p>
<pre class="programlisting">
SetEnv APPLICATION_ENV development

RewriteEngine On
RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^.*$ - [NC,L]
RewriteRule ^.*$ index.php [NC,L]
</pre>
<div class="note"><table border="0" summary="Note: Learn about mod_rewrite">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[注意]" src="images/note.png"></td>
<th align="left">Learn about mod_rewrite</th>
</tr>
<tr><td align="left" valign="top"><p>
                The above rewrite rules allow access to any file under your
                virtual host's document root. If there are files you do not want
                exposed in this way, you may want to be more restrictive in your
                rules. Go to the Apache website to <a href="http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html" target="_top">learn
                more about mod_rewrite</a>.
            </p></td></tr>
</table></div>
<p>
            At this point, you're all set to start taking advantage of
            <code class="classname">Zend_Application</code>.
        </p>
</div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.application.quick-start.resources"></a>4.2.3. Adding and creating resources</h3></div></div></div>
<p>
            If you followed the directions above, then your bootstrap class
            will be utilizing a front controller, and when it is run, it will
            dispatch the front controller. However, in all likelihood, you'll
            need a little more configuration than this.
        </p>
<p>
            In this section, we'll look at adding two resources to your
            application. First, we'll set up your layouts, and then we'll
            customize your view object.
        </p>
<p>
            One of the standard resources provided with
            <code class="classname">Zend_Application</code> is the "layout" resource. This
            resource expects you to define configuration values which it will
            then use to configure your <code class="classname">Zend_Layout</code> instance.
        </p>
<p>
            To use it, all we need to do is update the configuration file.
        </p>
<pre class="programlisting">
[production]
phpSettings.display_startup_errors = 0
phpSettings.display_errors = 0
bootstrap.path = APPLICATION_PATH "/Bootstrap.php"
bootstrap.class = "Bootstrap"
resources.frontController.controllerDirectory = APPLICATION_PATH "/controllers"
; ADD THE FOLLOWING LINES
resources.layout.layout = "layout"
resources.layout.layoutPath = APPLICATION_PATH "/layouts/scripts"

[staging : production]

[testing : production]
phpSettings.display_startup_errors = 1
phpSettings.display_errors = 1

[development : production]
phpSettings.display_startup_errors = 1
phpSettings.display_errors = 1
</pre>
<p>
            If you haven't already, create the directory
            <code class="filename">application/layouts/scripts/</code>, and the file
            <code class="filename">layout.phtml</code> within that directory. A good starting
            layout is as follows (and ties in with the view resource covered
            next):
        </p>
<pre class="programlisting">
&lt;?php echo $this-&gt;doctype() ?&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;?php echo $this-&gt;headTitle() ?&gt;
    &lt;?php echo $this-&gt;headLink() ?&gt;
    &lt;?php echo $this-&gt;headStyle() ?&gt;
    &lt;?php echo $this-&gt;headScript() ?&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;?php echo $this-&gt;layout()-&gt;content ?&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre>
<p>
            At this point, you will now have a working layout.
        </p>
<p>
            Now, we'll add a custom view resource. When initializing the view,
            we'll want to set the <acronym class="acronym">HTML</acronym> DocType and a default value for the title
            to use in the <acronym class="acronym">HTML</acronym> head. This can be accomplished by editing your
            <code class="classname">Bootstrap</code> class to add a method:
        </p>
<pre class="programlisting">
class Bootstrap extends Zend_Application_Bootstrap_Bootstrap
{
    protected function _initView()
    {
        // Initialize view
        $view = new Zend_View();
        $view-&gt;doctype('XHTML1_STRICT');
        $view-&gt;headTitle('My First Zend Framework Application');

        // Add it to the ViewRenderer
        $viewRenderer = Zend_Controller_Action_HelperBroker::getStaticHelper(
            'ViewRenderer'
        );
        $viewRenderer-&gt;setView($view);

        // Return it, so that it can be stored by the bootstrap
        return $view;
    }
}
</pre>
<p>
            This method will be automatically executed when you bootstrap the
            application, and will ensure your view is initialized according to
            your application needs.
        </p>
</div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.application.quick-start.next-steps"></a>4.2.4. Next steps with Zend_Application</h3></div></div></div>
<p>
            The above should get you started with <code class="classname">Zend_Application</code>
            and creating your application bootstrap. From here, you should start
            creating resource methods, or, for maximum re-usability, resource
            plugin classes. Continue reading to learn more!
        </p>
</div>
</div>
<div class="navfooter"><table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="zend.application.html">上一页</a> </td>
<td width="20%" align="center"><a accesskey="u" href="zend.application.html">上一级</a></td>
<td width="40%" align="right"> <a accesskey="n" href="zend.application.theory-of-operation.html">下一页</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">第 4 章 Zend_Application </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td>
<td width="40%" align="right" valign="top"> 4.3. Theory of Operation</td>
</tr>
</table></div>
<div class="revinfo"></div>
</body>
</html>
