<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>24.3. Using the Book Search Data API</title>
<link rel="stylesheet" href="dbstyle.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.72.0">
<link rel="start" href="index.html" title="Zend Framework手册 中文版">
<link rel="up" href="zend.gdata.html" title="第 24 章 Zend_Gdata">
<link rel="prev" href="zend.gdata.authsub.html" title="24.2. Authenticating with AuthSub">
<link rel="next" href="zend.gdata.clientlogin.html" title="24.4. Authenticating with ClientLogin">
<link rel="chapter" href="introduction.html" title="第 1 章 Zend Framework简介">
<link rel="chapter" href="zend.acl.html" title="第 2 章 Zend_Acl">
<link rel="chapter" href="zend.amf.html" title="第 3 章 Zend_Amf">
<link rel="chapter" href="zend.application.html" title="第 4 章 Zend_Application">
<link rel="chapter" href="zend.auth.html" title="第 5 章 Zend_Auth">
<link rel="chapter" href="zend.cache.html" title="第 6 章 Zend_Cache">
<link rel="chapter" href="zend.captcha.html" title="第 7 章 Zend_Captcha">
<link rel="chapter" href="zend.codegenerator.html" title="第 8 章 Zend_CodeGenerator">
<link rel="chapter" href="zend.config.html" title="第 9 章 Zend_Config">
<link rel="chapter" href="zend.config.writer.html" title="第 10 章 Zend_Config_Writer">
<link rel="chapter" href="zend.console.getopt.html" title="第 11 章 Zend_Console_Getopt">
<link rel="chapter" href="zend.controller.html" title="第 12 章 Zend_Controller">
<link rel="chapter" href="zend.currency.html" title="第 13 章 Zend_Currency">
<link rel="chapter" href="zend.date.html" title="第 14 章 Zend_Date">
<link rel="chapter" href="zend.db.html" title="第 15 章 Zend_Db">
<link rel="chapter" href="zend.debug.html" title="第 16 章 Zend_Debug">
<link rel="chapter" href="zend.dojo.html" title="第 17 章 Zend_Dojo">
<link rel="chapter" href="zend.dom.html" title="第 18 章 Zend_Dom">
<link rel="chapter" href="zend.exception.html" title="第 19 章 Zend_Exception">
<link rel="chapter" href="zend.feed.html" title="第 20 章 Zend_Feed">
<link rel="chapter" href="zend.file.html" title="第 21 章 Zend_File">
<link rel="chapter" href="zend.filter.html" title="第 22 章 Zend_Filter">
<link rel="chapter" href="zend.form.html" title="第 23 章 Zend_Form">
<link rel="chapter" href="zend.gdata.html" title="第 24 章 Zend_Gdata">
<link rel="chapter" href="zend.http.html" title="第 25 章 Zend_Http">
<link rel="chapter" href="zend.infocard.html" title="第 26 章 Zend_InfoCard">
<link rel="chapter" href="zend.json.html" title="第 27 章 Zend_Json">
<link rel="chapter" href="zend.layout.html" title="第 28 章 Zend_Layout">
<link rel="chapter" href="zend.ldap.html" title="第 29 章 Zend_Ldap">
<link rel="chapter" href="zend.loader.html" title="第 30 章 Zend_Loader">
<link rel="chapter" href="zend.locale.html" title="第 31 章 Zend_Locale">
<link rel="chapter" href="zend.log.html" title="第 32 章 Zend_Log">
<link rel="chapter" href="zend.mail.html" title="第 33 章 Zend_Mail">
<link rel="chapter" href="zend.measure.html" title="第 34 章 Zend_Measure">
<link rel="chapter" href="zend.memory.html" title="第 35 章 Zend_Memory">
<link rel="chapter" href="zend.mime.html" title="第 36 章 Zend_Mime">
<link rel="chapter" href="zend.navigation.html" title="第 37 章 Zend_Navigation">
<link rel="chapter" href="zend.openid.html" title="第 38 章 Zend_OpenId">
<link rel="chapter" href="zend.paginator.html" title="第 39 章 Zend_Paginator">
<link rel="chapter" href="zend.pdf.html" title="第 40 章 Zend_Pdf">
<link rel="chapter" href="zend.progressbar.html" title="第 41 章 Zend_ProgressBar">
<link rel="chapter" href="zend.queue.html" title="第 42 章 Zend_Queue">
<link rel="chapter" href="zend.reflection.html" title="第 43 章 Zend_Reflection">
<link rel="chapter" href="zend.registry.html" title="第 44 章 Zend_Registry">
<link rel="chapter" href="zend.rest.html" title="第 45 章 Zend_Rest">
<link rel="chapter" href="zend.search.lucene.html" title="第 46 章 Zend_Search_Lucene">
<link rel="chapter" href="zend.server.html" title="第 47 章 Zend_Server">
<link rel="chapter" href="zend.service.html" title="第 48 章 Zend_Service">
<link rel="chapter" href="zend.session.html" title="第 49 章 Zend_Session">
<link rel="chapter" href="zend.soap.html" title="第 50 章 Zend_Soap">
<link rel="chapter" href="zend.tag.html" title="第 51 章 Zend_Tag">
<link rel="chapter" href="zend.test.html" title="第 52 章 Zend_Test">
<link rel="chapter" href="zend.text.html" title="第 53 章 Zend_Text">
<link rel="chapter" href="zend.timesync.html" title="第 54 章 Zend_TimeSync">
<link rel="chapter" href="zend.tool.framework.html" title="第 55 章 Zend_Tool_Framework">
<link rel="chapter" href="zend.tool.project.html" title="第 56 章 Zend_Tool_Project">
<link rel="chapter" href="zend.translate.html" title="第 57 章 Zend_Translate">
<link rel="chapter" href="zend.uri.html" title="第 58 章 Zend_Uri">
<link rel="chapter" href="zend.validate.html" title="第 59 章 Zend_Validate">
<link rel="chapter" href="zend.version.html" title="第 60 章 Zend_Version">
<link rel="chapter" href="zend.view.html" title="第 61 章 Zend_View">
<link rel="chapter" href="zend.wildfire.html" title="第 62 章 Zend_Wildfire">
<link rel="chapter" href="zend.xmlrpc.html" title="第 63 章 Zend_XmlRpc">
<link rel="chapter" href="zendx.console.process.unix.html" title="第 64 章 ZendX_Console_Process_Unix">
<link rel="chapter" href="zendx.jquery.html" title="第 65 章 ZendX_JQuery">
<link rel="appendix" href="requirements.html" title="附录 A. 系统需求">
<link rel="appendix" href="coding-standard.html" title="附录 B. Zend Framework 的 PHP 编码标准">
<link rel="appendix" href="doc-standard.html" title="附录 C. Zend Framework Documentation Standard">
<link rel="appendix" href="project-structure.html" title="附录 D. Recommended Project Structure for Zend Framework MVC Applications">
<link rel="appendix" href="performance.html" title="附录 E. Zend Framework Performance Guide">
<link rel="appendix" href="copyrights.html" title="附录 F. 版权信息">
<link rel="index" href="the.index.html" title="索引">
<link rel="subsection" href="zend.gdata.books.html#zend.gdata.books.authentication" title="24.3.1. Authenticating to the Book Search service">
<link rel="subsection" href="zend.gdata.books.html#zend.gdata.books.searching_for_books" title="24.3.2. Searching for books">
<link rel="subsection" href="zend.gdata.books.html#zend.gdata.books.community_features" title="24.3.3. Using community features">
<link rel="subsection" href="zend.gdata.books.html#zend.gdata.books.sharing_with_my_library" title="24.3.4. Book collections and My Library">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader"><table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">24.3. Using the Book Search Data API</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="zend.gdata.authsub.html">上一页</a> </td>
<th width="60%" align="center">第 24 章 Zend_Gdata</th>
<td width="20%" align="right"> <a accesskey="n" href="zend.gdata.clientlogin.html">下一页</a>
</td>
</tr>
</table></div>
<div class="sect1" lang="zh-cn">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="zend.gdata.books"></a>24.3. Using the Book Search Data API</h2></div></div></div>
<p>
        The Google Book Search Data <acronym class="acronym">API</acronym> allows client applications to view
        and update Book Search content in the form of Google Data <acronym class="acronym">API</acronym> feeds.
    </p>
<p>
        Your client application can use the Book Search Data <acronym class="acronym">API</acronym> to issue
        full-text searches for books and to retrieve standard book information,
        ratings, and reviews. You can also access individual users'
        <a href="http://books.google.com/googlebooks/mylibrary/" target="_top">library collections and
        public reviews</a>. Finally, your application can submit authenticated requests
        to enable users to create and modify library collections, ratings, labels,
        reviews, and other account-specific entities.
    </p>
<p>
        For more information on the Book Search Data <acronym class="acronym">API</acronym>, please refer to the official
        <a href="http://code.google.com/apis/books/gdata/developers_guide_php.html" target="_top">PHP
        Developer's Guide</a> on code.google.com.
    </p>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.gdata.books.authentication"></a>24.3.1. Authenticating to the Book Search service</h3></div></div></div>
<p>
            You can access both public and private feeds using the Book Search
            Data <acronym class="acronym">API</acronym>. Public feeds don't require any authentication, but they are
            read-only. If you want to modify user libraries, submit reviews or
            ratings, or add labels, then your client needs to authenticate before
            requesting private feeds. It can authenticate using either of two
            approaches: AuthSub proxy authentication or ClientLogin username/password
            authentication. Please refer to the <a href="http://code.google.com/apis/books/gdata/developers_guide_php.html#Authentication" target="_top">
            Authentication section in the <acronym class="acronym">PHP</acronym> Developer's Guide</a> for more detail.
        </p>
</div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.gdata.books.searching_for_books"></a>24.3.2. Searching for books</h3></div></div></div>
<p>
            The Book Search Data <acronym class="acronym">API</acronym> provides a number of feeds that list collections of books.
        </p>
<p>
            The most common action is to retrieve a list of books that match a
            search query. To do so you create a <code class="code">VolumeQuery</code> object
            and pass it to the <code class="code">Books::getVolumeFeed</code> method.
        </p>
<p>
            For example, to perform a keyword query, with a filter on
            viewability to restrict the results to partial or full view books, use
            the <code class="code">setMinViewability</code> and <code class="code">setQuery</code> methods
            of the <code class="code">VolumeQuery</code> object. The following code snippet prints
            the title and viewability of all volumes whose metadata or text matches
            the query term "domino":
        </p>
<pre class="programlisting">
$books = new Zend_Gdata_Books();
$query = $books-&gt;newVolumeQuery();

$query-&gt;setQuery('domino');
$query-&gt;setMinViewability('partial_view');

$feed = $books-&gt;getVolumeFeed($query);

foreach ($feed as $entry) {
    echo $entry-&gt;getVolumeId();
    echo $entry-&gt;getTitle();
    echo $entry-&gt;getViewability();
}
</pre>
<p>
            The <code class="code">Query</code> class, and subclasses like
            <code class="code">VolumeQuery</code>, are responsible for constructing feed
            <acronym class="acronym">URL</acronym>s. The VolumeQuery shown above constructs a <acronym class="acronym">URL</acronym> equivalent to the
            following:
        </p>
<pre class="programlisting">
http://www.google.com/books/feeds/volumes?q=keyword&amp;amp;min-viewability=partial
</pre>
<p>
            Note: Since Book Search results are
            public, you can issue a Book Search query without authentication.
        </p>
<p>
            Here are some of the most common <code class="code">VolumeQuery</code>
            methods for setting search parameters:
        </p>
<p>
            <code class="code">setQuery:</code> Specifies a search
            query term. Book Search searches all book metadata and full text for
            books matching the term. Book metadata includes titles, keywords,
            descriptions, author names, and subjects.
            Note that any spaces, quotes or other punctuation in the parameter
            value must be <acronym class="acronym">URL</acronym>-escaped. (Use a plus (<code class="code">+</code>) for a space.)
            To search for an exact phrase, enclose the phrase in quotation marks.
            For example, to search for books matching the phrase "spy plane", set
            the <code class="code">q</code> parameter to <code class="code">%22spy+plane%22</code>.
            You can also use any of the <a href="http://books.google.com/advanced_book_search" target="_top">
            advanced search operators</a> supported by Book Search. For example,
            <code class="code">jane+austen+-inauthor:austen</code> returns matches that mention
            (but are not authored by) Jane Austen.
        </p>
<p>
            <code class="code">setStartIndex:</code> Specifies
            the index of the first matching result that should be included in the
            result set. This parameter uses a one-based index, meaning the first
            result is 1, the second result is 2 and so forth. This parameter works
            in conjunction with the max-results
            parameter to determine which results to return. For example, to
            request the third set of 10 results—results 21-30—set
            the <code class="code">start-index</code> parameter to <code class="code">21</code> and the
            max-results parameter to <code class="code">10</code>.
            Note: This isn't a general cursoring
            mechanism. If you first send a query with
            <code class="code">?start-index=1&amp;max-results=10</code> and then send another
            query with <code class="code">?start-index=11&amp;max-results=10</code>, the
            service cannot guarantee that the results are equivalent to
            <code class="code">?start-index=1&amp;max-results=20</code>, because insertions and
            deletions could have taken place in between the two queries.
        </p>
<p>
            <code class="code">setMaxResults:</code>
            Specifies the maximum number of results that should be included
            in the result set. This parameter works in conjunction with the
            start-index parameter to determine which
            results to return. The default value of this parameter is
            <code class="code">10</code> and the maximum value is <code class="code">20</code>.
        </p>
<p>
            <code class="code">setMinViewability:</code>
            Allows you to filter the results according to the books'
            <a href="http://code.google.com/apis/books/docs/dynamic-links.html#terminology" target="_top">
            viewability status</a>.
            This parameter accepts one of three values: <code class="code">'none'</code>
            (the default, returning all matching books regardless of
            viewability), <code class="code">'partial_view'</code> (returning only books
            that the user can preview or view in their entirety), or
            <code class="code">'full_view'</code> (returning only books that the user can
            view in their entirety).
        </p>
<div class="sect3" lang="zh-cn">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.gdata.books.partner_restrict"></a>24.3.2.1. Partner Co-Branded Search</h4></div></div></div>
<p>
                Google Book Search provides <a href="http://books.google.com/support/partner/bin/answer.py?hl=en&amp;answer=65113" target="_top">
                Co-Branded Search</a>, which lets content partners provide full-text search of
                their books from their own websites.
            </p>
<p>
                If you are a partner who wants to do Co-Branded Search using the
                Book Search Data <acronym class="acronym">API</acronym>, you may do so by modifying the feed <acronym class="acronym">URL</acronym> above to
                point to your Co-Branded Search implementation. If, for example, a
                Co-Branded Search is available at the following <acronym class="acronym">URL</acronym>:
            </p>
<pre class="programlisting">
http://www.google.com/books/p/PARTNER_COBRAND_ID?q=ball
</pre>
<p>
                then you can obtain the same results using the Book Search Data <acronym class="acronym">API</acronym> at the
                following <acronym class="acronym">URL</acronym>:
            </p>
<pre class="programlisting">
http://www.google.com/books/feeds/p/PARTNER_COBRAND_ID/volumes?q=ball+-soccer
</pre>
<p>
                To specify an alternate <acronym class="acronym">URL</acronym> when querying a volume feed, you can
                provide an extra parameter to <code class="code">newVolumeQuery</code>
            </p>
<pre class="programlisting">
$query =
    $books-&gt;newVolumeQuery('http://www.google.com/books/p/PARTNER_COBRAND_ID');
</pre>
<p>
                For additional information or support, visit our
                <a href="http://books.google.com/support/partner/" target="_top">Partner help center</a>.
            </p>
</div>
</div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.gdata.books.community_features"></a>24.3.3. Using community features</h3></div></div></div>
<div class="sect3" lang="zh-cn">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.gdata.books.adding_ratings"></a>24.3.3.1. Adding a rating</h4></div></div></div>
<p>
                A user can add a rating to a book. Book Search uses a 1-5
                rating system in which 1 is the lowest rating. Users cannot
                update or delete ratings.
            </p>
<p>
                To add a rating, add a <code class="code">Rating</code> object to a
                <code class="code">VolumeEntry</code> and post it to the annotation feed.
                In the example below, we start from an empty <code class="code">VolumeEntry</code> object.
            </p>
<pre class="programlisting">
$entry = new Zend_Gdata_Books_VolumeEntry();
$entry-&gt;setId(new Zend_Gdata_App_Extension_Id(VOLUME_ID));
$entry-&gt;setRating(new Zend_Gdata_Extension_Rating(3, 1, 5, 1));
$books-&gt;insertVolume($entry, Zend_Gdata_Books::MY_ANNOTATION_FEED_URI);
</pre>
</div>
<div class="sect3" lang="zh-cn">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.gdata.books.reviews"></a>24.3.3.2. Reviews</h4></div></div></div>
<p>
                In addition to ratings, authenticated users can submit reviews or
                edit their reviews. For information on how to request previously
                submitted reviews, see <a href="#zend.gdata.books.retrieving_annotations" target="_top">Retrieving annotations</a>.
            </p>
<div class="sect4" lang="zh-cn">
<div class="titlepage"><div><div><h5 class="title">
<a name="zend.gdata.books.adding_review"></a>24.3.3.2.1. Adding a review</h5></div></div></div>
<p>
                    To add a review, add a <code class="code">Review</code> object to a
                    <code class="code">VolumeEntry</code> and post it to the annotation
                    feed. In the example below, we start from an existing
                    <code class="code">VolumeEntry</code> object.
                </p>
<pre class="programlisting">
$annotationUrl = $entry-&gt;getAnnotationLink()-&gt;href;
$review        = new Zend_Gdata_Books_Extension_Review();

$review-&gt;setText("This book is amazing!");
$entry-&gt;setReview($review);
$books-&gt;insertVolume($entry, $annotationUrl);
</pre>
</div>
<div class="sect4" lang="zh-cn">
<div class="titlepage"><div><div><h5 class="title">
<a name="zend.gdata.books.editing_review"></a>24.3.3.2.2. Editing a review</h5></div></div></div>
<p>
                    To update an existing review, first you retrieve the
                    review you want to update, then you modify it, and
                    then you submit it to the annotation feed.
                </p>
<pre class="programlisting">
$entryUrl = $entry-&gt;getId()-&gt;getText();
$review   = new Zend_Gdata_Books_Extension_Review();

$review-&gt;setText("This book is actually not that good!");
$entry-&gt;setReview($review);
$books-&gt;updateVolume($entry, $entryUrl);
</pre>
</div>
</div>
<div class="sect3" lang="zh-cn">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.gdata.books.labels"></a>24.3.3.3. Labels</h4></div></div></div>
<p>
                You can use the Book Search Data <acronym class="acronym">API</acronym> to label volumes with
                keywords. A user can submit, retrieve and modify labels. See
                <a href="#zend.gdata.books.retrieving_annotations" target="_top">Retrieving
                annotations</a> for how to read previously submitted labels.
            </p>
<div class="sect4" lang="zh-cn">
<div class="titlepage"><div><div><h5 class="title">
<a name="zend.gdata.books.submitting_labels"></a>24.3.3.3.1. Submitting a set of labels</h5></div></div></div>
<p>
                    To submit labels, add a <code class="code">Category</code> object
                    with the scheme <code class="constant">LABELS_SCHEME</code> to a
                    <code class="code">VolumeEntry</code> and post it to the annotation feed.
                </p>
<pre class="programlisting">
$annotationUrl = $entry-&gt;getAnnotationLink()-&gt;href;
$category      = new Zend_Gdata_App_Extension_Category(
    'rated',
    'http://schemas.google.com/books/2008/labels');
$entry-&gt;setCategory(array($category));
$books-&gt;insertVolume($entry, Zend_Gdata_Books::MY_ANNOTATION_FEED_URI);
</pre>
</div>
</div>
<div class="sect3" lang="zh-cn">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.gdata.books.retrieving_annotations"></a>24.3.3.4. Retrieving annotations: reviews, ratings, and labels</h4></div></div></div>
<p>
                You can use the Book Search Data <acronym class="acronym">API</acronym> to retrieve annotations
                submitted by a given user. Annotations include reviews, ratings, and
                labels. To retrieve any user's annotations, you can send an
                unauthenticated request that includes the user's user ID. To retrieve the
                authenticated user's annotations, use the value <code class="code">me</code> as the user ID.
            </p>
<pre class="programlisting">
$feed = $books-&gt;getVolumeFeed(
            'http://www.google.com/books/feeds/users/USER_ID/volumes');
&lt;i&gt;(or)&lt;/i&gt;
$feed = $books-&gt;getUserAnnotationFeed();

// print title(s) and rating value
foreach ($feed as $entry) {
    foreach ($feed-&gt;getTitles() as $title) {
        echo $title;
    }
    if ($entry-&gt;getRating()) {
        echo 'Rating: ' . $entry-&gt;getRating()-&gt;getAverage();
    }
}
</pre>
<p>
                For a list of the supported query parameters, see the
                <a href="#zend.gdata.books.query_parameters" target="_top">query parameters</a>
                section.
            </p>
</div>
<div class="sect3" lang="zh-cn">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.gdata.books.deleting_annotations"></a>24.3.3.5. Deleting Annotations</h4></div></div></div>
<p>
                If you retrieved an annotation entry containing ratings,
                reviews, and/or labels, you can remove all annotations
                by calling <code class="code">deleteVolume</code> on that entry.
            </p>
<pre class="programlisting">
$books-&gt;deleteVolume($entry);
</pre>
</div>
</div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.gdata.books.sharing_with_my_library"></a>24.3.4. Book collections and My Library</h3></div></div></div>
<p>
            Google Book Search provides a number of user-specific
            book collections, each of which has its own feed.
        </p>
<p>
            The most important collection is the user's My Library, which
            represents the books the user would like to remember, organize, and
            share with others. This is the collection the user sees when accessing
            his or her <a href="http://books.google.com/books?op=library" target="_top">My Library
            page</a>.
        </p>
<div class="sect3" lang="zh-cn">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.gdata.books.retrieving_books_in_library"></a>24.3.4.1. Retrieving books in a user's library</h4></div></div></div>
<p>
                The following sections describe how to retrieve a list
                of books from a user's library, with or without query
                parameters.
            </p>
<p>
                You can query a Book Search public feed without authentication.
            </p>
<div class="sect4" lang="zh-cn">
<div class="titlepage"><div><div><h5 class="title">
<a name="zend.gdata.books.retrieving_all_books_in_library"></a>24.3.4.1.1. Retrieving all books in a user's library</h5></div></div></div>
<p>
                    To retrieve the user's books, send a query to the
                    My Library feed. To get the library of the authenticated
                    user, use <code class="code">me</code> in place of <code class="constant">USER_ID</code>.
                </p>
<pre class="programlisting">
$feed = $books-&gt;getUserLibraryFeed();
</pre>
<p>
                    Note: The feed may not contain all of the user's books, because
                    there's a default limit on the number of results returned. For
                    more information, see the <code class="code">max-results</code> query parameter in
                    <a href="#zend.gdata.books.searching_for_books" target="_top">Searching for books</a>.
                </p>
</div>
<div class="sect4" lang="zh-cn">
<div class="titlepage"><div><div><h5 class="title">
<a name="zend.gdata.books.retrieving_books_in_library_with_query"></a>24.3.4.1.2. Searching for books in a user's library</h5></div></div></div>
<p>
                    Just as you can <a href="#zend.gdata.books.searching_for_books" target="_top">search across all books</a>,
                    you can do a full-text search over just the books in a
                    user's library. To do this, just set the appropriate
                    paramters on the <code class="code">VolumeQuery</code> object.
                </p>
<p>
                    For example, the following query returns all the books in
                    your library that contain the word "bear":
                </p>
<pre class="programlisting">
$query = $books-&gt;newVolumeQuery(
    'http://www.google.com/books/feeds/users' .
    '/USER_ID/collections/library/volumes');
$query-&gt;setQuery('bear');
$feed = $books-&gt;getVolumeFeed($query);
</pre>
<p>
                    For a list of the supported query parameters, see the
                    <a href="#zend.gdata.books.query_pParameters" target="_top">query parameters</a>
                    section. In addition, you can search for books that have been
                    <a href="#zend.gdata.books.labels" target="_top">labeled by the user</a>:
                </p>
<pre class="programlisting">
$query = $books-&gt;newVolumeQuery(
    'http://www.google.com/books/feeds/users/' .
    'USER_ID/collections/library/volumes');
$query-&gt;setCategory(
$query-&gt;setCategory('favorites');
$feed = $books-&gt;getVolumeFeed($query);
</pre>
</div>
</div>
<div class="sect3" lang="zh-cn">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.gdata.books.updating_library"></a>24.3.4.2. Updating books in a user's library</h4></div></div></div>
<p>
                You can use the Book Search Data <acronym class="acronym">API</acronym> to add a book to, or remove a
                book from, a user's library. Ratings, reviews, and labels are valid
                across all the collections of a user, and are thus edited using the
                annotation feed (see <a href="#zend.gdata.books.community_features" target="_top">Using community features</a>).
            </p>
<div class="sect4" lang="zh-cn">
<div class="titlepage"><div><div><h5 class="title">
<a name="zend.gdata.books.library_book_add"></a>24.3.4.2.1. Adding a book to a library</h5></div></div></div>
<p>
                    After authenticating, you can add books to the current user's library.
                </p>
<p>
                    You can either create an entry from scratch if you
                    know the volume ID, or insert an entry read from any feed.
                </p>
<p>
                    The following example creates a new entry and adds it to the library:
                </p>
<pre class="programlisting">
$entry = new Zend_Gdata_Books_VolumeEntry();
$entry-&gt;setId(new Zend_Gdata_App_Extension_Id(VOLUME_ID));
$books-&gt;insertVolume(
    $entry,
    Zend_Gdata_Books::MY_LIBRARY_FEED_URI
);
</pre>
<p>
                    The following example adds an existing
                    <code class="code">VolumeEntry</code> object to the library:
                </p>
<pre class="programlisting">
$books-&gt;insertVolume(
    $entry,
    Zend_Gdata_Books::MY_LIBRARY_FEED_URI
);
</pre>
</div>
<div class="sect4" lang="zh-cn">
<div class="titlepage"><div><div><h5 class="title">
<a name="zend.gdata.books.library_book_remove"></a>24.3.4.2.2. Removing a book from a library</h5></div></div></div>
<p>
                    To remove a book from a user's library, call
                    <code class="code">deleteVolume</code> on the <code class="code">VolumeEntry</code> object.
                </p>
<pre class="programlisting">
$books-&gt;deleteVolume($entry);
</pre>
</div>
</div>
</div>
</div>
<div class="navfooter"><table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="zend.gdata.authsub.html">上一页</a> </td>
<td width="20%" align="center"><a accesskey="u" href="zend.gdata.html">上一级</a></td>
<td width="40%" align="right"> <a accesskey="n" href="zend.gdata.clientlogin.html">下一页</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">24.2. Authenticating with AuthSub </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td>
<td width="40%" align="right" valign="top"> 24.4. Authenticating with ClientLogin</td>
</tr>
</table></div>
<div class="revinfo"></div>
</body>
</html>
